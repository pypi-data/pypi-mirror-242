import re
def extract_nginx_name(s):
    match = re.search('(rp_nginx\d+)', s)
    if match:
        result = match.group(1)
    return result

def extract_date(s):
    match = re.search('service/([^/]*)', s)
    if match:
        result = match.group(1)
    return result

def coss_sql(file_path_list):
    oss_sql_list = []
    insert_sql_list = []
    for i,file_path in enumerate(file_path_list):
        f_num = extract_nginx_name(file_path)
        f_date = extract_date(file_path)
        oss_sql = f"""
-- {i}
drop table if exists lebo_data.oss_service_{f_num}_{f_date}_ext;
drop table if exists lebo_data.src_service_{f_num}_{f_date}_ext;
        """


        oss_sql_list.append(oss_sql)
        # insert_sql_list.append(insert_sql)
    oss_sql_string = '\n'.join(oss_sql_list)
    # insert_sql_string = 'insert into lebo_data.src_service_kafka_oss_ext_temp partition(p_date)' + '\nunion all'.join(insert_sql_list) + ';'
    f = open("D:\workspace_python\mjm\mjm\lebo_utils\mc\oss_data.txt", "w")
    # 将Hello World写入文件中
    f.write(oss_sql_string)
    # 关闭文件对象
    f.close()



if __name__ == '__main__':
    file_path_list = ['oss://bigdata-log-report/log/rp_nginx01/service/20230901/', 'oss://bigdata-log-report/log/rp_nginx01/service/20230902/', 'oss://bigdata-log-report/log/rp_nginx01/service/20230903/', 'oss://bigdata-log-report/log/rp_nginx01/service/20230904/', 'oss://bigdata-log-report/log/rp_nginx01/service/20230905/', 'oss://bigdata-log-report/log/rp_nginx01/service/20230906/', 'oss://bigdata-log-report/log/rp_nginx01/service/20230907/', 'oss://bigdata-log-report/log/rp_nginx01/service/20230908/', 'oss://bigdata-log-report/log/rp_nginx01/service/20230909/', 'oss://bigdata-log-report/log/rp_nginx01/service/20230910/', 'oss://bigdata-log-report/log/rp_nginx01/service/20230911/', 'oss://bigdata-log-report/log/rp_nginx01/service/20230912/', 'oss://bigdata-log-report/log/rp_nginx01/service/20230913/', 'oss://bigdata-log-report/log/rp_nginx01/service/20230914/', 'oss://bigdata-log-report/log/rp_nginx01/service/20230915/', 'oss://bigdata-log-report/log/rp_nginx01/service/20230916/', 'oss://bigdata-log-report/log/rp_nginx01/service/20230917/', 'oss://bigdata-log-report/log/rp_nginx01/service/20230918/', 'oss://bigdata-log-report/log/rp_nginx01/service/20230919/', 'oss://bigdata-log-report/log/rp_nginx01/service/20230920/', 'oss://bigdata-log-report/log/rp_nginx01/service/20230921/', 'oss://bigdata-log-report/log/rp_nginx01/service/20230922/', 'oss://bigdata-log-report/log/rp_nginx01/service/20230923/', 'oss://bigdata-log-report/log/rp_nginx01/service/20230924/', 'oss://bigdata-log-report/log/rp_nginx01/service/20230925/', 'oss://bigdata-log-report/log/rp_nginx01/service/20230926/', 'oss://bigdata-log-report/log/rp_nginx01/service/20230927/', 'oss://bigdata-log-report/log/rp_nginx01/service/20230928/', 'oss://bigdata-log-report/log/rp_nginx01/service/20230929/', 'oss://bigdata-log-report/log/rp_nginx01/service/20230930/', 'oss://bigdata-log-report/log/rp_nginx01/service/20231001/', 'oss://bigdata-log-report/log/rp_nginx01/service/20231002/', 'oss://bigdata-log-report/log/rp_nginx01/service/20231003/', 'oss://bigdata-log-report/log/rp_nginx01/service/20231004/', 'oss://bigdata-log-report/log/rp_nginx01/service/20231005/', 'oss://bigdata-log-report/log/rp_nginx01/service/20231006/', 'oss://bigdata-log-report/log/rp_nginx01/service/20231007/', 'oss://bigdata-log-report/log/rp_nginx01/service/20231008/', 'oss://bigdata-log-report/log/rp_nginx02/service/20230901/', 'oss://bigdata-log-report/log/rp_nginx02/service/20230902/', 'oss://bigdata-log-report/log/rp_nginx02/service/20230903/', 'oss://bigdata-log-report/log/rp_nginx02/service/20230904/', 'oss://bigdata-log-report/log/rp_nginx02/service/20230905/', 'oss://bigdata-log-report/log/rp_nginx02/service/20230906/', 'oss://bigdata-log-report/log/rp_nginx02/service/20230907/', 'oss://bigdata-log-report/log/rp_nginx02/service/20230908/', 'oss://bigdata-log-report/log/rp_nginx02/service/20230909/', 'oss://bigdata-log-report/log/rp_nginx02/service/20230910/', 'oss://bigdata-log-report/log/rp_nginx02/service/20230911/', 'oss://bigdata-log-report/log/rp_nginx02/service/20230912/', 'oss://bigdata-log-report/log/rp_nginx02/service/20230913/', 'oss://bigdata-log-report/log/rp_nginx02/service/20230914/', 'oss://bigdata-log-report/log/rp_nginx02/service/20230915/', 'oss://bigdata-log-report/log/rp_nginx02/service/20230916/', 'oss://bigdata-log-report/log/rp_nginx02/service/20230917/', 'oss://bigdata-log-report/log/rp_nginx02/service/20230918/', 'oss://bigdata-log-report/log/rp_nginx02/service/20230919/', 'oss://bigdata-log-report/log/rp_nginx02/service/20230920/', 'oss://bigdata-log-report/log/rp_nginx02/service/20230921/', 'oss://bigdata-log-report/log/rp_nginx02/service/20230922/', 'oss://bigdata-log-report/log/rp_nginx02/service/20230923/', 'oss://bigdata-log-report/log/rp_nginx02/service/20230924/', 'oss://bigdata-log-report/log/rp_nginx02/service/20230925/', 'oss://bigdata-log-report/log/rp_nginx02/service/20230926/', 'oss://bigdata-log-report/log/rp_nginx02/service/20230927/', 'oss://bigdata-log-report/log/rp_nginx02/service/20230928/', 'oss://bigdata-log-report/log/rp_nginx02/service/20230929/', 'oss://bigdata-log-report/log/rp_nginx02/service/20230930/', 'oss://bigdata-log-report/log/rp_nginx02/service/20231001/', 'oss://bigdata-log-report/log/rp_nginx02/service/20231002/', 'oss://bigdata-log-report/log/rp_nginx02/service/20231003/', 'oss://bigdata-log-report/log/rp_nginx02/service/20231004/', 'oss://bigdata-log-report/log/rp_nginx02/service/20231005/', 'oss://bigdata-log-report/log/rp_nginx02/service/20231006/', 'oss://bigdata-log-report/log/rp_nginx02/service/20231007/', 'oss://bigdata-log-report/log/rp_nginx02/service/20231008/', 'oss://bigdata-log-report/log/rp_nginx03/service/20230901/', 'oss://bigdata-log-report/log/rp_nginx03/service/20230902/', 'oss://bigdata-log-report/log/rp_nginx03/service/20230903/', 'oss://bigdata-log-report/log/rp_nginx03/service/20230904/', 'oss://bigdata-log-report/log/rp_nginx03/service/20230905/', 'oss://bigdata-log-report/log/rp_nginx03/service/20230906/', 'oss://bigdata-log-report/log/rp_nginx03/service/20230907/', 'oss://bigdata-log-report/log/rp_nginx03/service/20230908/', 'oss://bigdata-log-report/log/rp_nginx03/service/20230918/', 'oss://bigdata-log-report/log/rp_nginx03/service/20230919/', 'oss://bigdata-log-report/log/rp_nginx03/service/20230920/', 'oss://bigdata-log-report/log/rp_nginx04/service/20230901/', 'oss://bigdata-log-report/log/rp_nginx04/service/20230902/', 'oss://bigdata-log-report/log/rp_nginx04/service/20230903/', 'oss://bigdata-log-report/log/rp_nginx04/service/20230904/', 'oss://bigdata-log-report/log/rp_nginx04/service/20230905/', 'oss://bigdata-log-report/log/rp_nginx04/service/20230906/', 'oss://bigdata-log-report/log/rp_nginx04/service/20230907/', 'oss://bigdata-log-report/log/rp_nginx04/service/20230908/', 'oss://bigdata-log-report/log/rp_nginx04/service/20230909/', 'oss://bigdata-log-report/log/rp_nginx04/service/20230910/', 'oss://bigdata-log-report/log/rp_nginx04/service/20230911/', 'oss://bigdata-log-report/log/rp_nginx04/service/20230912/', 'oss://bigdata-log-report/log/rp_nginx04/service/20230913/', 'oss://bigdata-log-report/log/rp_nginx04/service/20230914/', 'oss://bigdata-log-report/log/rp_nginx04/service/20230915/', 'oss://bigdata-log-report/log/rp_nginx04/service/20230916/', 'oss://bigdata-log-report/log/rp_nginx04/service/20230917/', 'oss://bigdata-log-report/log/rp_nginx04/service/20230918/', 'oss://bigdata-log-report/log/rp_nginx04/service/20230919/', 'oss://bigdata-log-report/log/rp_nginx05/service/20230901/', 'oss://bigdata-log-report/log/rp_nginx05/service/20230902/', 'oss://bigdata-log-report/log/rp_nginx05/service/20230903/', 'oss://bigdata-log-report/log/rp_nginx05/service/20230904/', 'oss://bigdata-log-report/log/rp_nginx05/service/20230905/', 'oss://bigdata-log-report/log/rp_nginx05/service/20230906/', 'oss://bigdata-log-report/log/rp_nginx05/service/20230907/', 'oss://bigdata-log-report/log/rp_nginx05/service/20230908/', 'oss://bigdata-log-report/log/rp_nginx05/service/20230909/', 'oss://bigdata-log-report/log/rp_nginx05/service/20230910/', 'oss://bigdata-log-report/log/rp_nginx05/service/20230911/', 'oss://bigdata-log-report/log/rp_nginx05/service/20230912/', 'oss://bigdata-log-report/log/rp_nginx05/service/20230913/', 'oss://bigdata-log-report/log/rp_nginx05/service/20230914/', 'oss://bigdata-log-report/log/rp_nginx05/service/20230915/', 'oss://bigdata-log-report/log/rp_nginx05/service/20230916/', 'oss://bigdata-log-report/log/rp_nginx05/service/20230917/', 'oss://bigdata-log-report/log/rp_nginx05/service/20230918/', 'oss://bigdata-log-report/log/rp_nginx05/service/20230919/', 'oss://bigdata-log-report/log/rp_nginx05/service/20230920/', 'oss://bigdata-log-report/log/rp_nginx05/service/20230921/', 'oss://bigdata-log-report/log/rp_nginx05/service/20230922/', 'oss://bigdata-log-report/log/rp_nginx05/service/20230923/', 'oss://bigdata-log-report/log/rp_nginx05/service/20230924/', 'oss://bigdata-log-report/log/rp_nginx05/service/20230929/', 'oss://bigdata-log-report/log/rp_nginx05/service/20230930/', 'oss://bigdata-log-report/log/rp_nginx05/service/20231001/', 'oss://bigdata-log-report/log/rp_nginx05/service/20231002/', 'oss://bigdata-log-report/log/rp_nginx06/service/20230901/', 'oss://bigdata-log-report/log/rp_nginx06/service/20230902/', 'oss://bigdata-log-report/log/rp_nginx06/service/20230903/', 'oss://bigdata-log-report/log/rp_nginx06/service/20230904/', 'oss://bigdata-log-report/log/rp_nginx06/service/20230905/', 'oss://bigdata-log-report/log/rp_nginx06/service/20230906/', 'oss://bigdata-log-report/log/rp_nginx06/service/20230907/', 'oss://bigdata-log-report/log/rp_nginx06/service/20230908/', 'oss://bigdata-log-report/log/rp_nginx06/service/20230909/', 'oss://bigdata-log-report/log/rp_nginx06/service/20230910/', 'oss://bigdata-log-report/log/rp_nginx06/service/20230911/', 'oss://bigdata-log-report/log/rp_nginx06/service/20230912/', 'oss://bigdata-log-report/log/rp_nginx06/service/20230913/', 'oss://bigdata-log-report/log/rp_nginx06/service/20230914/', 'oss://bigdata-log-report/log/rp_nginx06/service/20230915/', 'oss://bigdata-log-report/log/rp_nginx06/service/20230916/', 'oss://bigdata-log-report/log/rp_nginx06/service/20230917/', 'oss://bigdata-log-report/log/rp_nginx06/service/20230918/', 'oss://bigdata-log-report/log/rp_nginx06/service/20230919/', 'oss://bigdata-log-report/log/rp_nginx06/service/20230920/', 'oss://bigdata-log-report/log/rp_nginx06/service/20230921/', 'oss://bigdata-log-report/log/rp_nginx06/service/20230922/', 'oss://bigdata-log-report/log/rp_nginx06/service/20230923/', 'oss://bigdata-log-report/log/rp_nginx06/service/20230924/', 'oss://bigdata-log-report/log/rp_nginx06/service/20230925/', 'oss://bigdata-log-report/log/rp_nginx06/service/20230926/', 'oss://bigdata-log-report/log/rp_nginx06/service/20230927/', 'oss://bigdata-log-report/log/rp_nginx06/service/20230928/', 'oss://bigdata-log-report/log/rp_nginx06/service/20230929/', 'oss://bigdata-log-report/log/rp_nginx06/service/20230930/', 'oss://bigdata-log-report/log/rp_nginx06/service/20231001/', 'oss://bigdata-log-report/log/rp_nginx06/service/20231002/', 'oss://bigdata-log-report/log/rp_nginx07/service/20230901/', 'oss://bigdata-log-report/log/rp_nginx07/service/20230902/', 'oss://bigdata-log-report/log/rp_nginx07/service/20230903/', 'oss://bigdata-log-report/log/rp_nginx07/service/20230904/', 'oss://bigdata-log-report/log/rp_nginx07/service/20230905/', 'oss://bigdata-log-report/log/rp_nginx07/service/20230906/', 'oss://bigdata-log-report/log/rp_nginx07/service/20230907/', 'oss://bigdata-log-report/log/rp_nginx07/service/20230908/', 'oss://bigdata-log-report/log/rp_nginx07/service/20230909/', 'oss://bigdata-log-report/log/rp_nginx07/service/20230910/', 'oss://bigdata-log-report/log/rp_nginx07/service/20230911/', 'oss://bigdata-log-report/log/rp_nginx07/service/20230912/', 'oss://bigdata-log-report/log/rp_nginx07/service/20230913/', 'oss://bigdata-log-report/log/rp_nginx07/service/20230914/', 'oss://bigdata-log-report/log/rp_nginx07/service/20230915/', 'oss://bigdata-log-report/log/rp_nginx07/service/20230916/', 'oss://bigdata-log-report/log/rp_nginx07/service/20230917/', 'oss://bigdata-log-report/log/rp_nginx07/service/20230918/', 'oss://bigdata-log-report/log/rp_nginx07/service/20230919/', 'oss://bigdata-log-report/log/rp_nginx07/service/20230920/', 'oss://bigdata-log-report/log/rp_nginx07/service/20230921/', 'oss://bigdata-log-report/log/rp_nginx07/service/20230922/', 'oss://bigdata-log-report/log/rp_nginx07/service/20230923/', 'oss://bigdata-log-report/log/rp_nginx07/service/20230924/', 'oss://bigdata-log-report/log/rp_nginx07/service/20230925/', 'oss://bigdata-log-report/log/rp_nginx07/service/20230926/', 'oss://bigdata-log-report/log/rp_nginx07/service/20230927/', 'oss://bigdata-log-report/log/rp_nginx07/service/20230928/', 'oss://bigdata-log-report/log/rp_nginx07/service/20230929/', 'oss://bigdata-log-report/log/rp_nginx07/service/20230930/', 'oss://bigdata-log-report/log/rp_nginx07/service/20231001/', 'oss://bigdata-log-report/log/rp_nginx07/service/20231002/', 'oss://bigdata-log-report/log/rp_nginx07/service/20231003/', 'oss://bigdata-log-report/log/rp_nginx07/service/20231004/', 'oss://bigdata-log-report/log/rp_nginx07/service/20231005/', 'oss://bigdata-log-report/log/rp_nginx07/service/20231006/', 'oss://bigdata-log-report/log/rp_nginx07/service/20231007/', 'oss://bigdata-log-report/log/rp_nginx07/service/20231008/', 'oss://bigdata-log-report/log/rp_nginx08/service/20230901/', 'oss://bigdata-log-report/log/rp_nginx08/service/20230902/', 'oss://bigdata-log-report/log/rp_nginx08/service/20230903/', 'oss://bigdata-log-report/log/rp_nginx08/service/20230904/', 'oss://bigdata-log-report/log/rp_nginx08/service/20230905/', 'oss://bigdata-log-report/log/rp_nginx08/service/20230906/', 'oss://bigdata-log-report/log/rp_nginx08/service/20230907/', 'oss://bigdata-log-report/log/rp_nginx08/service/20230908/', 'oss://bigdata-log-report/log/rp_nginx08/service/20230909/', 'oss://bigdata-log-report/log/rp_nginx08/service/20230910/', 'oss://bigdata-log-report/log/rp_nginx08/service/20230911/', 'oss://bigdata-log-report/log/rp_nginx08/service/20230912/', 'oss://bigdata-log-report/log/rp_nginx08/service/20230913/', 'oss://bigdata-log-report/log/rp_nginx08/service/20230914/', 'oss://bigdata-log-report/log/rp_nginx08/service/20230915/', 'oss://bigdata-log-report/log/rp_nginx08/service/20230916/', 'oss://bigdata-log-report/log/rp_nginx08/service/20230917/', 'oss://bigdata-log-report/log/rp_nginx08/service/20230918/', 'oss://bigdata-log-report/log/rp_nginx08/service/20230919/', 'oss://bigdata-log-report/log/rp_nginx08/service/20230920/', 'oss://bigdata-log-report/log/rp_nginx08/service/20230921/', 'oss://bigdata-log-report/log/rp_nginx08/service/20230922/', 'oss://bigdata-log-report/log/rp_nginx08/service/20230923/', 'oss://bigdata-log-report/log/rp_nginx08/service/20230924/', 'oss://bigdata-log-report/log/rp_nginx08/service/20230925/', 'oss://bigdata-log-report/log/rp_nginx08/service/20230926/', 'oss://bigdata-log-report/log/rp_nginx08/service/20230927/', 'oss://bigdata-log-report/log/rp_nginx08/service/20230928/', 'oss://bigdata-log-report/log/rp_nginx08/service/20230929/', 'oss://bigdata-log-report/log/rp_nginx08/service/20230930/', 'oss://bigdata-log-report/log/rp_nginx08/service/20231001/', 'oss://bigdata-log-report/log/rp_nginx08/service/20231002/', 'oss://bigdata-log-report/log/rp_nginx08/service/20231003/', 'oss://bigdata-log-report/log/rp_nginx08/service/20231004/', 'oss://bigdata-log-report/log/rp_nginx08/service/20231005/', 'oss://bigdata-log-report/log/rp_nginx08/service/20231006/', 'oss://bigdata-log-report/log/rp_nginx08/service/20231007/', 'oss://bigdata-log-report/log/rp_nginx08/service/20231008/', 'oss://bigdata-log-report/log/rp_nginx09/service/20230901/', 'oss://bigdata-log-report/log/rp_nginx09/service/20230902/', 'oss://bigdata-log-report/log/rp_nginx09/service/20230903/', 'oss://bigdata-log-report/log/rp_nginx09/service/20230904/', 'oss://bigdata-log-report/log/rp_nginx09/service/20230905/', 'oss://bigdata-log-report/log/rp_nginx09/service/20230906/', 'oss://bigdata-log-report/log/rp_nginx09/service/20230907/', 'oss://bigdata-log-report/log/rp_nginx09/service/20230908/', 'oss://bigdata-log-report/log/rp_nginx09/service/20230909/', 'oss://bigdata-log-report/log/rp_nginx09/service/20230910/', 'oss://bigdata-log-report/log/rp_nginx09/service/20230911/', 'oss://bigdata-log-report/log/rp_nginx09/service/20230912/', 'oss://bigdata-log-report/log/rp_nginx09/service/20230913/', 'oss://bigdata-log-report/log/rp_nginx09/service/20230914/', 'oss://bigdata-log-report/log/rp_nginx09/service/20230915/', 'oss://bigdata-log-report/log/rp_nginx09/service/20230916/', 'oss://bigdata-log-report/log/rp_nginx09/service/20230917/', 'oss://bigdata-log-report/log/rp_nginx09/service/20230918/', 'oss://bigdata-log-report/log/rp_nginx09/service/20230919/', 'oss://bigdata-log-report/log/rp_nginx09/service/20230920/', 'oss://bigdata-log-report/log/rp_nginx09/service/20230921/', 'oss://bigdata-log-report/log/rp_nginx09/service/20230922/', 'oss://bigdata-log-report/log/rp_nginx09/service/20230923/', 'oss://bigdata-log-report/log/rp_nginx09/service/20230924/', 'oss://bigdata-log-report/log/rp_nginx09/service/20230925/', 'oss://bigdata-log-report/log/rp_nginx09/service/20230926/', 'oss://bigdata-log-report/log/rp_nginx09/service/20230927/', 'oss://bigdata-log-report/log/rp_nginx09/service/20230928/', 'oss://bigdata-log-report/log/rp_nginx09/service/20230929/', 'oss://bigdata-log-report/log/rp_nginx09/service/20230930/', 'oss://bigdata-log-report/log/rp_nginx09/service/20231001/', 'oss://bigdata-log-report/log/rp_nginx09/service/20231002/', 'oss://bigdata-log-report/log/rp_nginx09/service/20231003/', 'oss://bigdata-log-report/log/rp_nginx09/service/20231004/', 'oss://bigdata-log-report/log/rp_nginx09/service/20231005/', 'oss://bigdata-log-report/log/rp_nginx09/service/20231006/', 'oss://bigdata-log-report/log/rp_nginx09/service/20231007/', 'oss://bigdata-log-report/log/rp_nginx09/service/20231008/', 'oss://bigdata-log-report/log/rp_nginx10/service/20230901/', 'oss://bigdata-log-report/log/rp_nginx10/service/20230902/', 'oss://bigdata-log-report/log/rp_nginx10/service/20230903/', 'oss://bigdata-log-report/log/rp_nginx10/service/20230904/', 'oss://bigdata-log-report/log/rp_nginx10/service/20230905/', 'oss://bigdata-log-report/log/rp_nginx10/service/20230906/', 'oss://bigdata-log-report/log/rp_nginx10/service/20230907/', 'oss://bigdata-log-report/log/rp_nginx10/service/20230908/', 'oss://bigdata-log-report/log/rp_nginx10/service/20230909/', 'oss://bigdata-log-report/log/rp_nginx10/service/20230910/', 'oss://bigdata-log-report/log/rp_nginx10/service/20230911/', 'oss://bigdata-log-report/log/rp_nginx10/service/20230912/', 'oss://bigdata-log-report/log/rp_nginx10/service/20230913/', 'oss://bigdata-log-report/log/rp_nginx10/service/20230914/', 'oss://bigdata-log-report/log/rp_nginx10/service/20230915/', 'oss://bigdata-log-report/log/rp_nginx10/service/20230916/', 'oss://bigdata-log-report/log/rp_nginx10/service/20230917/', 'oss://bigdata-log-report/log/rp_nginx10/service/20230918/', 'oss://bigdata-log-report/log/rp_nginx10/service/20230919/', 'oss://bigdata-log-report/log/rp_nginx10/service/20230920/', 'oss://bigdata-log-report/log/rp_nginx10/service/20230921/', 'oss://bigdata-log-report/log/rp_nginx10/service/20230922/', 'oss://bigdata-log-report/log/rp_nginx10/service/20230923/', 'oss://bigdata-log-report/log/rp_nginx10/service/20230924/', 'oss://bigdata-log-report/log/rp_nginx10/service/20230925/', 'oss://bigdata-log-report/log/rp_nginx10/service/20230926/', 'oss://bigdata-log-report/log/rp_nginx10/service/20230927/', 'oss://bigdata-log-report/log/rp_nginx10/service/20230928/', 'oss://bigdata-log-report/log/rp_nginx10/service/20230929/', 'oss://bigdata-log-report/log/rp_nginx10/service/20230930/', 'oss://bigdata-log-report/log/rp_nginx10/service/20231001/', 'oss://bigdata-log-report/log/rp_nginx10/service/20231002/', 'oss://bigdata-log-report/log/rp_nginx10/service/20231003/', 'oss://bigdata-log-report/log/rp_nginx10/service/20231004/', 'oss://bigdata-log-report/log/rp_nginx10/service/20231005/', 'oss://bigdata-log-report/log/rp_nginx10/service/20231006/', 'oss://bigdata-log-report/log/rp_nginx10/service/20231007/', 'oss://bigdata-log-report/log/rp_nginx10/service/20231008/', 'oss://bigdata-log-report/log/rp_nginx11/service/20230901/', 'oss://bigdata-log-report/log/rp_nginx11/service/20230902/', 'oss://bigdata-log-report/log/rp_nginx11/service/20230903/', 'oss://bigdata-log-report/log/rp_nginx11/service/20230904/', 'oss://bigdata-log-report/log/rp_nginx11/service/20230905/', 'oss://bigdata-log-report/log/rp_nginx11/service/20230906/', 'oss://bigdata-log-report/log/rp_nginx11/service/20230907/', 'oss://bigdata-log-report/log/rp_nginx11/service/20230908/', 'oss://bigdata-log-report/log/rp_nginx11/service/20230909/', 'oss://bigdata-log-report/log/rp_nginx11/service/20230910/', 'oss://bigdata-log-report/log/rp_nginx11/service/20230911/', 'oss://bigdata-log-report/log/rp_nginx11/service/20230912/', 'oss://bigdata-log-report/log/rp_nginx11/service/20230913/', 'oss://bigdata-log-report/log/rp_nginx11/service/20230914/', 'oss://bigdata-log-report/log/rp_nginx11/service/20230915/', 'oss://bigdata-log-report/log/rp_nginx11/service/20230916/', 'oss://bigdata-log-report/log/rp_nginx11/service/20230917/', 'oss://bigdata-log-report/log/rp_nginx11/service/20230918/', 'oss://bigdata-log-report/log/rp_nginx11/service/20230919/', 'oss://bigdata-log-report/log/rp_nginx11/service/20230920/', 'oss://bigdata-log-report/log/rp_nginx11/service/20230921/', 'oss://bigdata-log-report/log/rp_nginx11/service/20230922/', 'oss://bigdata-log-report/log/rp_nginx11/service/20230923/', 'oss://bigdata-log-report/log/rp_nginx11/service/20230924/', 'oss://bigdata-log-report/log/rp_nginx11/service/20230925/', 'oss://bigdata-log-report/log/rp_nginx11/service/20230926/', 'oss://bigdata-log-report/log/rp_nginx11/service/20230927/', 'oss://bigdata-log-report/log/rp_nginx11/service/20230928/', 'oss://bigdata-log-report/log/rp_nginx11/service/20230929/', 'oss://bigdata-log-report/log/rp_nginx11/service/20230930/', 'oss://bigdata-log-report/log/rp_nginx11/service/20231001/', 'oss://bigdata-log-report/log/rp_nginx11/service/20231002/', 'oss://bigdata-log-report/log/rp_nginx11/service/20231003/', 'oss://bigdata-log-report/log/rp_nginx11/service/20231004/', 'oss://bigdata-log-report/log/rp_nginx11/service/20231005/', 'oss://bigdata-log-report/log/rp_nginx11/service/20231006/', 'oss://bigdata-log-report/log/rp_nginx11/service/20231007/', 'oss://bigdata-log-report/log/rp_nginx11/service/20231008/', 'oss://bigdata-log-report/log/rp_nginx12/service/20230901/', 'oss://bigdata-log-report/log/rp_nginx12/service/20230902/', 'oss://bigdata-log-report/log/rp_nginx12/service/20230903/', 'oss://bigdata-log-report/log/rp_nginx12/service/20230904/', 'oss://bigdata-log-report/log/rp_nginx12/service/20230905/', 'oss://bigdata-log-report/log/rp_nginx12/service/20230906/', 'oss://bigdata-log-report/log/rp_nginx12/service/20230907/', 'oss://bigdata-log-report/log/rp_nginx12/service/20230908/', 'oss://bigdata-log-report/log/rp_nginx12/service/20230909/', 'oss://bigdata-log-report/log/rp_nginx12/service/20230910/', 'oss://bigdata-log-report/log/rp_nginx12/service/20230911/', 'oss://bigdata-log-report/log/rp_nginx12/service/20230912/', 'oss://bigdata-log-report/log/rp_nginx12/service/20230913/', 'oss://bigdata-log-report/log/rp_nginx12/service/20230914/', 'oss://bigdata-log-report/log/rp_nginx12/service/20230915/', 'oss://bigdata-log-report/log/rp_nginx12/service/20230916/', 'oss://bigdata-log-report/log/rp_nginx12/service/20230917/', 'oss://bigdata-log-report/log/rp_nginx12/service/20230918/', 'oss://bigdata-log-report/log/rp_nginx12/service/20230919/', 'oss://bigdata-log-report/log/rp_nginx12/service/20230920/', 'oss://bigdata-log-report/log/rp_nginx12/service/20230921/', 'oss://bigdata-log-report/log/rp_nginx12/service/20230922/', 'oss://bigdata-log-report/log/rp_nginx12/service/20230923/', 'oss://bigdata-log-report/log/rp_nginx12/service/20230924/', 'oss://bigdata-log-report/log/rp_nginx12/service/20230925/', 'oss://bigdata-log-report/log/rp_nginx12/service/20230926/', 'oss://bigdata-log-report/log/rp_nginx12/service/20230927/', 'oss://bigdata-log-report/log/rp_nginx12/service/20230928/', 'oss://bigdata-log-report/log/rp_nginx12/service/20230929/', 'oss://bigdata-log-report/log/rp_nginx12/service/20230930/', 'oss://bigdata-log-report/log/rp_nginx12/service/20231001/', 'oss://bigdata-log-report/log/rp_nginx12/service/20231002/', 'oss://bigdata-log-report/log/rp_nginx12/service/20231003/', 'oss://bigdata-log-report/log/rp_nginx12/service/20231004/', 'oss://bigdata-log-report/log/rp_nginx12/service/20231005/', 'oss://bigdata-log-report/log/rp_nginx12/service/20231006/', 'oss://bigdata-log-report/log/rp_nginx12/service/20231007/', 'oss://bigdata-log-report/log/rp_nginx12/service/20231008/']
    date_list = []
    for i in file_path_list:
        if extract_date(i) in [str(j) for j in range(20230901,20231006)]:
            date_list.append(i)
            # print(i)
    # print(date_list)
    coss_sql(date_list)
    