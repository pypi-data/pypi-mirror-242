[LOCAL_SEND_INITIAL]
FILE = templates/00_local_send_initial.sh
PLATFORM = marenostrum_archive
#DEPENDENCIES = LOCAL_SEND_INITIAL-1
#because different dates (chunk = day):
RUNNING = chunk
NOTIFY_ON = FAILED COMPLETED

[LOCAL_SEND_SPINUP]
FILE = templates/00d_local_send_spinup.sh
PLATFORM = marenostrum_archive
RUNNING = member
NOTIFY_ON = FAILED COMPLETED

[LOCAL_SEND_SOURCE]
FILE = templates/01_local_send_source.sh
PLATFORM = marenostrum_archive
RUNNING = once

[LOCAL_SEND_STATIC]
FILE = templates/01b_local_send_static.sh
PLATFORM = marenostrum_archive
RUNNING = once

[REMOTE_COMPILE]
FILE = templates/02_compile.sh
DEPENDENCIES = LOCAL_SEND_SOURCE
RUNNING = once
WALLCLOCK = 00:50
CUSTOM_DIRECTIVES = ["#SBATCH -p interactive"]

[PREPROCFIX]
FILE = templates/03_preproc_fix.sh
DEPENDENCIES = REMOTE_COMPILE LOCAL_SEND_STATIC
RUNNING = once
WALLCLOCK = 01:00

[LOCAL_SEND_INITIAL_EMISSIONS]
FILE = templates/00c_local_send_initial_emissions.sh
PLATFORM = marenostrum_archive
DEPENDENCIES = LOCAL_SEND_INITIAL_EMISSIONS-1 SIM-1
#because different dates (chunk = day):
RUNNING = chunk
NOTIFY_ON = FAILED COMPLETED

[PREPROCVAR]
FILE = templates/04_preproc_var.sh
DEPENDENCIES = LOCAL_SEND_INITIAL LOCAL_SEND_INITIAL_EMISSIONS PREPROCFIX
#In Autosubmit nomenclature chunk will be our days (because days is used for start days)
RUNNING = chunk
WALLCLOCK = 01:00
NOTIFY_ON = FAILED COMPLETED

#** A domain of simulation has Ni x Nj grid cells. The maximum number of cpus that the HERMES can run is Ni/2.
[HERMES]
FILE = templates/05a_hermes.sh
DEPENDENCIES = LOCAL_SEND_SOURCE LOCAL_SEND_INITIAL LOCAL_SEND_INITIAL_EMISSIONS
RUNNING = chunk
WALLCLOCK = 00:20
PROCESSORS = 96
DELAY = 1
CUSTOM_DIRECTIVES = ["#SBATCH --exclusive"]

#** Remember to define a proper wallclock matching the configuration (resolution) of the model **
#** Remember that PROCESSORS must be equal to INPES*JNPES+WRTSK **
[SIM]
FILE = templates/05b_sim.sh
DEPENDENCIES = LOCAL_SEND_SPINUP PREMEGAN-1 PREPROCVAR SIM-1 HERMES
RUNNING = chunk
PROCESSORS = 1032
WALLCLOCK = 06:00
NOTIFY_ON = FAILED COMPLETED

[PREMEGAN]
FILE = templates/05d_premegan.sh
DEPENDENCIES = SIM
RUNNING = chunk
WALLCLOCK = 01:00
PROCESSORS = 1

[ARCHIVE]
FILE = templates/06_archive.sh
DEPENDENCIES = PREMEGAN+1 ARCHIVE-1
PLATFORM = marenostrum_archive
RUNNING = chunk
WALLCLOCK = 00:10
NOTIFY_ON = FAILED COMPLETED

[REDUCE]
FILE = templates/07_reduce.sh
DEPENDENCIES = ARCHIVE REDUCE-1
PLATFORM = power9
RUNNING = chunk
WALLCLOCK = 01:00
NOTIFY_ON = FAILED COMPLETED

[CLEAN]
FILE = templates/08_clean.sh
DEPENDENCIES = REDUCE
RUNNING = date
WALLCLOCK = 00:10
NOTIFY_ON = FAILED COMPLETED
