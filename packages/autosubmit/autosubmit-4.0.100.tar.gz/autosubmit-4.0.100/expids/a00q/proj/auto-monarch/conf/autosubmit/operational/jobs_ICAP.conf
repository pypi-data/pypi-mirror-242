[LOCAL_SEND_INITIAL]
FILE = templates/00_local_send_initial.sh
PLATFORM = marenostrum_archive
DEPENDENCIES = LOCAL_SEND_INITIAL-1
#because different dates (chunk = day):
RUNNING = chunk
NOTIFY_ON = FAILED

[LOCAL_SEND_SOURCE]
FILE = templates/01_local_send_source.sh
PLATFORM = LOCAL
RUNNING = once

[LOCAL_SEND_STATIC]
FILE = templates/01b_local_send_static.sh
PLATFORM = marenostrum_archive
RUNNING = once

[REMOTE_COMPILE]
FILE = templates/02_compile.sh
DEPENDENCIES = LOCAL_SEND_SOURCE
RUNNING = once
WALLCLOCK = 00:50
CUSTOM_DIRECTIVES = ["#SBATCH -p interactive"]

[PREPROC_FIX]
FILE = templates/03_preproc_fix.sh
DEPENDENCIES = REMOTE_COMPILE LOCAL_SEND_STATIC
RUNNING = once
WALLCLOCK = 01:00
CUSTOM_DIRECTIVES = ["#SBATCH -p interactive"]

[PREPROC_VAR]
FILE = templates/04_preproc_var.sh
DEPENDENCIES = LOCAL_SEND_INITIAL PREPROC_FIX PREPROC_VAR-1 SIM-1
#In Autosubmit nomenclature chunk will be our days (because days is used for start days)
RUNNING = chunk
WALLCLOCK = 00:25
NOTIFY_ON = FAILED
#CUSTOM_DIRECTIVES = ["#SBATCH --reservation=forecast"]
CUSTOM_DIRECTIVES = ["#SBATCH --qos=debug"]

[HERMES]
FILE = templates/05a_hermes.sh
DEPENDENCIES = LOCAL_SEND_SOURCE LOCAL_SEND_INITIAL
RUNNING = chunk
WALLCLOCK = 02:00
PROCESSORS = 96
NOTIFY_ON = FAILED
CUSTOM_DIRECTIVES = ["#SBATCH --exclusive", "#SBATCH --constraint=highmem"]
#CUSTOM_DIRECTIVES = ["#SBATCH --exclusive", "#SBATCH --reservation=forecast-earth", "#SBATCH --constraint=highmem"]

#** Remember to define a proper wallclock matching the configuration (resolution) of the model **
#** Remember that PROCESSORS must be equal to INPES*JNPES+WRTSK **
[SIM]
FILE = templates/05_sim.sh
DEPENDENCIES = PREMEGAN-1 PREPROC_VAR SIM-1 HERMES
RUNNING = chunk
PROCESSORS = 260
WALLCLOCK = 02:00
NOTIFY_ON = FAILED
#CUSTOM_DIRECTIVES = ["#SBATCH --reservation=forecast", "#SBATCH --exclusive"]
CUSTOM_DIRECTIVES = ["#SBATCH --qos=debug"]

[PREMEGAN]
FILE = templates/05c_premegan.sh
DEPENDENCIES = SIM
RUNNING = chunk
WALLCLOCK = 01:00
PROCESSORS = 1
#CUSTOM_DIRECTIVES = ["#SBATCH --reservation=forecast", "#SBATCH --exclusive"]
CUSTOM_DIRECTIVES = ["#SBATCH --qos=debug"]

[POST]
FILE = templates/06_post.sh
DEPENDENCIES = PREMEGAN
RUNNING = chunk
WALLCLOCK = 02:00
NOTIFY_ON = FAILED
#CUSTOM_DIRECTIVES = ["#SBATCH --reservation=forecast", "#SBATCH --exclusive"]
CUSTOM_DIRECTIVES = ["#SBATCH --qos=debug"]

[ARCHIVE]
FILE = templates/07_archive.sh
DEPENDENCIES = POST
PLATFORM = marenostrum_archive
RUNNING = chunk
WALLCLOCK = 00:10
NOTIFY_ON = FAILED
#CUSTOM_DIRECTIVES = ["#SBATCH --reservation=forecast"]
CUSTOM_DIRECTIVES = ["#SBATCH --qos=debug"]

[CLEAN]
FILE = templates/08_clean.sh
DEPENDENCIES = ARCHIVE
RUNNING = date
WALLCLOCK = 00:10
NOTIFY_ON = FAILED
CUSTOM_DIRECTIVES = ["#SBATCH --qos=debug"]
