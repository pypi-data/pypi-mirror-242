[monarch]
#-----------------------------------------------------------------------
# NEW: NESTING CONFIGURATION
# PREPROC configuration
#-----------------------------------------------------------------------
# Version of the preproc (0=FIX-VAR, 1=NPS) to be used. If NPS selected, remember to change the PREPROC_FIX job to run for each member!
VERSION_PREPROC         = 0
# Number of domains (=1 no nesting; >1 nesting domains)
NUM_DOMAINS             = 1

#-----------------------------------------------------------------------
# NEW NPS PREPROC and NESTING configuration!!!!
# Note: Parameters with several columns are for parent (first column) and nest domains (next columns)
#-----------------------------------------------------------------------
# Parent domain type (=1 global; =0 regional)
GLOBAL_NPS              = 0
# Meteorology bondary conditions frequency in s
BC_INTERVAL             = 21600
# Boundary width (standard = 1)
LNSH                    = 1
LNSV                    = 1
# Number of grid cells in West-East direction for each domain
# For nested domains, NX = NEST1RATIO * number_of_cells_over_parent + 1
# For DA, it will fail if it has more than 1 domain.
NX                      = 351 301 281
# Number of grid cells in North-South direction for each domain
# For nested domains, NY = NEST1RATIO * number_of_cells_over_parent + 1
# For DA, it will fail if it has more than 1 domain.
NY                      = 271 301 249
# Number of vertical layers (common for all domains)
NZ                      = 24
# Longitudinal grid resolution of parent domain in degrees
DX                      = 0.2
# Latitudinal grid resolution of parent domain in degrees
DY                      = 0.2
# Resolution of static data geogrid
# To use USGS select one of the available resolutions (10m/5m/2m/30s), to use ESA landcover map (available from 1995 to 2020 every 5 years) select one of the following labels (30s_esa_1995/30s_esa_2000/.../30s_esa_2020).
GEOG_DATA_RES           = 2m 2m 30s
# Parent id for each domain (0 for the upper parent)
PARENT_IDS              = 0 1 2
# Parent to nest domain ratio (first column always 1 for parent domain)
NEST1RATIO              = 1 4 4
# Center point latitudinal for each domain
CENLAT                  = 51.0 39.97 41.64
# Center point longitudinal for each domain
CENLON                  = 10.0 -3.16 1.72
# Pressure top of the domain (Pa)
PTOP_NPS                = 5000.
# Pressure transition for vertical coordinate sigma to pressure (Pa)
PTSGM                   = 30000.
# By default vertical levels are automatic. If user wants to spcify the sigmas use LEVELS
LEVELS                  =
#LEVELS="0.0,.025,.050,.074,.099,.124,.148,.171,.190,.208,.226,.245,.266,.288,.311,.335,.360,.384,.409,.433,.458,.482,.506,.530,.554,.577,.601,.623,.646,.667,.688,.708,.728,.747,.766,.784,.801,.818,.834,.845,.863,.877,.889,.890,.908,.916,.924,.930,.937,.943,.949,.955,.960,.965,.971,.976,.981,.986,.990,.995,1.0"
# Run time step for each domain (integer seconds)
dt_int=48 12 3
# For real timestep decimal values for each domain(dt_numerator/dt_denominator)
dt_num=0 0 0
dt_den=1 1 1
# Number of timesteps between radiation calls (both short and long wave)
nradsnps=75 300 1200
#-----------------------------------------------------------------------
# Compute tasks definition new NPS and NESTING (also change in jobs.conf)!
#-----------------------------------------------------------------------
# Number cores ungrib (only works with 1)
nproc_ungrib=1
# Number cores geogrid
nproc_geogrid=8
# Number cores metgrid
nproc_metgrid=8
# Number cores nemsinterp
nproc_nemsinterp=8
# Number inpes (MONARCH compute tasks in the I direction)
inpesnps= 10 19 34
# Number jnpes (MONARCH compute tasks in the J direction)
jnpesnps= 10 20 34
# Number write tasks
# It should evenly divide into the number of compute tasks in the J-direction on the grid (jnpesnps)
# for optimal balance of the output workload (although this is not a requirement).
wtpgnps=8 8 8
# Initial condition analysis files (GFS/FNL/ERA/ERA5/IFS/MERRA2_ERA5soil/GEFSAN[00..20]) for each ensemble member (they can differ per member):
SRC_GRIB=IFS
# Miscellaneous details (do not modify!!! Still under test)
VCOORD_OPT              = 1
spectral=.false.
direct_temp=.true.
## note that NCEP_PROC and DO_GWD are defined as false below for global runs
#
NCEP_PROC=.false.
NCEP_PROC_GRIB2=.true.
#
moving_nests=.false.
DO_GWD=.false. .false. .false.
DO_CLOUDS=.false.
#### USE_IGBP=0 --> USGS
#### USE_IGBP=1 --> IGBP
USE_IGBP=0
JUST_LAST=.false.

#-----------------------------------------------------------------------
# OLD PREPROC AND SINGLE DOMAIN CONFIGURATION!!!!
#-----------------------------------------------------------------------
# Compute tasks definition (also change in jobs.conf)!
#-----------------------------------------------------------------------
# Number inpes (compute tasks in the I direction)
INPES 			= 23
# Number jnpes (compute tasks in the J direction)
JNPES 			= 18
# Number write tasks
WRTSK 			= 8
# Make sure to change PROCESSORS (must be equal to INPES*JNPES+WRTSK) under [SIM] section in jobs_$EXPID.conf

#-----------------------------------------------------------------------
# Model domain setup
#-----------------------------------------------------------------------
# Type of simulation
MODE = REGIONAL_CHEM
# Name of the case (MEMBER will hang from CASE in paths) (global/regional)
CASE 			= regional
# Run time step (integer seconds)
DT_INT			= 45
# Center point longitudinal (E/W)
TLM0D			= 10.0
# Center point latitudinal (S/N)
TPH0D			= 51.0
# Western boundary (from center point)
# IMPORTANT: It has to be multiple of DLMD
WBD			= -35.0
# Southern boundary (from center point)
# IMPORTANT: It has to be multiple of DPHD
SBD 			= -27.0
# Longitudinal grid resolution
DLMD 			= 0.2
# Latitudinal grid resolution
DPHD			= 0.2
# Vertical model layers
LM			= 24
# Pressure top of the domain (Pa)
PTOP			= 5000.
# Mineral Dust Emission Calibration Factor
DCAL 			= 0.5 0.7 0.7
# Number of timesteps between radiation calls (short)
NRADS 			= 80
# Number of timesteps between radiation calls (long)
NRADL 			= 80

#-----------------------------------------------------------------------
# Ensemble perturbation factors
#-----------------------------------------------------------------------
DCALBIN1 = 1.0 1.000612 1.082477 1.475536 0.843028 1.423721 1.309229 0.811747 0.995270 1.524607 0.823556 0.475334
DCALBIN2 = 1.0 0.998531 1.074797 1.472015 0.850205 1.430319 1.299753 0.828486 1.002254 1.524329 0.830391 0.479323
DCALBIN3 = 1.0 0.987129 1.093450 1.487424 0.828624 1.437714 1.325002 0.839012 1.009480 1.547502 0.882344 0.468367
DCALBIN4 = 1.0 0.948493 1.082074 1.426227 0.866220 1.381353 1.371184 0.793838 1.048545 1.510950 0.816682 0.387790
DCALBIN5 = 1.0 0.935082 1.101794 1.365402 0.785977 1.493562 1.390100 0.629129 1.101997 1.638613 0.739484 0.426551
DCALBIN6 = 1.0 0.776795 1.287324 1.364965 0.912424 1.331407 1.327775 0.962559 0.923016 1.219089 0.897321 0.764757
DCALBIN7 = 1.0 0.882573 1.407303 0.662187 0.865147 0.802836 1.357229 1.397023 0.811385 0.815051 1.133981 1.124143
DCALBIN8 = 1.0 1.006390 0.886486 1.102514 1.394948 1.286722 1.174099 1.009974 0.945916 0.930637 1.395042 1.018455
PERTURB_USTH = 1.0 1.01643812 0.38722173 1.0121849 0.93356167 0.73258736 1.72922959 1.00050638 0.89468336 1.39104921 1.20099803 1.07560301

#-----------------------------------------------------------------------
#TUNING FOR SOIL HUMIDITY THRESHOLD AND WET DEPOSITION
#-----------------------------------------------------------------------

# Fecan coefficient (typically >= 1)
FECAN=1.75

# soil moisture scaling (typically <= 1)
# recommended to use either fecan or smccoef and not both at the same time
SMCCOEF=1.0

# erosion threshold scaling (typically <= 1)
CTHR=1.0

# tuning factor for coarse dust below cloud scavenging (grid scale clouds)
BCL_MP_C=50.

# tuning factor for medium dust below cloud scavenging (grid scale clouds)
BCL_MP_M=100.

# tuning factor for fine dust below cloud scavenging (grid scale clouds)
BCL_MP_F=100.

# tuning factor for coarse dust below cloud scavenging (convective clouds)
BCL_BMJ_C=50.

# tuning factor for medium dust below cloud scavenging (convective clouds)
BCL_BMJ_M=100.

# tuning factor for fine dust below cloud scavenging (convective clouds)
BCL_BMJ_F=100.

# tuning factor for dust incloud scavenging (grid scale clouds)
ICL_MP=1.

# tuning factor for dust incloud scavenging (convective clouds)
ICL_BMJ=4.

# sedimentation scheme (0-implicit,1 explicit) both upwind (pretty diffusive)
SEDIM_TYPE=1

# correction factor of sedimentation velocity for bin 5 to correct for diffusive scheme
VSED5=0.5

# correction factor of sedimentation velocity for bin 6 to correct for diffusive scheme
VSED6=0.3

# correction factor of sedimentation velocity for bin 7 to correct for diffusive scheme
VSED7=0.2

# correction factor of sedimentation velocity for bin 8 to correct for diffusive scheme
VSED8=0.1

# tuning factor for dry deposition velocity (excluding gravitational settling
VDRY=0.5

#-----------------------------------------------------------------------
#CHOICE OF DUST SOURCE, EMITTED SIZE DISTRIBUTION AND EMISSION SCHEME
#-----------------------------------------------------------------------

# 0 Old topographic source from Ginoux et al. (2001) derived at 0.25 degrees (DUSCHEME=0-7)
# 1 MODIS DB C6 based foo (climatology) derived at 0.1 degrees (both natural and anthropogenic together, HYDE 2) (DUSCHEME=0-7)
# 2 MODIS DB C6 based foo (climatology) derived at 0.1 degrees (tagged natural and anthropogenic, HYDE 2) (DUSCHEME=0-7)
# 3 Like #1 to identify the location of sources but like #0 (topo) for the calculation of the vertical flux (DUSCHEME=0,1,2)
# 4 Like #2 to identify the location of sources but like #0 (topo) for the calculation of the vertical flux (DUSCHEME=0,1,2)
#   (#3 and #4 are equivalent to #1 and #2 respectively in the case of DUSCHEME>=3)
#   (For the options above, in the case of DUSCHEME>=3 (Kok, Shao, Klose), SRC is only used to identify the location of the sources) 
# 5 No source based on topo or MODIS (only DMASK) and no tagging
# 6 No source based on topo or MODIS (only DMASK) and tagging for anthropogenic and natural based on MODIS DB 
#   [[[ the following options [7-14] use #0 (topo) for vertical flux in the case of DUSCHEME=0,1,2; no effect for DUSCHEME > 2 ]]]
# 7  MODIS DB foo and HYDE 3.2.1 land use at 0.1 degrees (natural and anthropogenic together), actual year
# 8  MODIS DB foo and HYDE 3.2.1 land use at 0.1 degrees (tagged natural and anthropogenic [cropland and pasture]), actual year
# 9  MODIS DB foo and HYDE 3.2.1 land use at 0.1 degrees (tagged natural and anthropogenic [cropland, pasture, and converted rangeland]), actual year
# 10 MODIS DB foo and HYDE 3.2.1 land use at 0.1 degrees (tagged natural and anthropogenic [cropland, pasture, conv. rangeland, and rangeland]), actual year
# 11 MODIS DB foo and HYDE 3.2.1 land use at 0.1 degrees (natural and anthropogenic together), climatology
# 12 MODIS DB foo and HYDE 3.2.1 land use at 0.1 degrees (tagged natural and anthropogenic [cropland and pasture]), climatology
# 13 MODIS DB foo and HYDE 3.2.1 land use at 0.1 degrees (tagged natural and anthropogenic [cropland, pasture, and converted rangeland]), climatology
# 14 MODIS DB foo and HYDE 3.2.1 land use at 0.1 degrees (tagged natural and anthropogenic [cropland, pasture, conv. rangeland, and rangeland]), climatology
# 100 Linear combination of schemes (with limitations. Need to provide DGRPSCHEME*, DGRPSRC*, DGRPDRAGPART* and DGRPMASK* )
#    Ensemble perturbations have been implemented only for DUSCHEME=0,1,2
#    Dust emission scheme for each ensemble member (they can differ per member)
SRC=3

# 0 Standard desert mask based on monthly vegetation fraction (Perez et al. 2011)
#   (If SRC=0 it uses the fixed and already masked topo source)
# 1 Based on MODIS C5 monthly LAI for the specific year (available for 2001 to 2015)
# 2 Based on MODIS C5 monthly LAI climatology (2001 to 2015)
# 3 Based on Landsat and MODIS reflectance (Guerschman et al. 2015) (monthly data, 01/2001 to 08/2018)
# 4 Based on Landsat and MODIS reflectance (Guerschman et al. 2015) (monthly climatology, 2001-2017)
DMASK=4

# 0 Use default USGS climatological vegetation for meteorology and land-surface while using vegetation from DMASK/DRAG_PART for dust 
# 1 Use same vegetation (Guerschman et al. 2015) for meteorology and land-surface as for dust (only applies if DMASK = 3 or 4 and DRAG_PART = 4)
VEGF_UNI=1

# 0 Bilinear interpolation of the New MODIS DB C6 foo sources and LAI to the model grid (recommended for resolutions < 0.1 deg)
# 1 Averaging the 0.1 deg new MODIS DB C6 foo sources and LAI over coarser resolution grid (recommended for resolutions > 0.1deg)
INTERP=1 0 0

# Always 1 for pringent roughness
INTERP2=1 0 0

# 0 Emitted size distribution from D'Almeida
# 1 Emitted size distribution from Kok
# 2 Emitted size distribution from Ginoux et al. (2001)
SZDSTR=1

# Dust emission scheme
# 0 Marticorena and Bergametti, NMMB default dust emission scheme (Perez et al 2011)
# 1 GOCART dust emission scheme from Paul Ginoux using 10 m wind (Klose et al., 2020)
# 2 GOCART dust emission scheme from Paul Ginoux using friction velocity (Klose et al., 2020)
# 3 KOK dust emission scheme (Kok et al. 2014)
# 4 SHAO (2001), JGR
# 5 SHAO (2004), JGR
# 6 SHAO et al. (2011), JGR - simplification of #5
# 100 Linear combination of schemes (with limitations. Need to provide DGRPSCHEME*, DGRPSRC*, DGRPDRAGPART* and DGRPMASK* )
#   Ensemble perturbations have been implemented only for DUSCHEME=0,1,2
#   Dust emission scheme for each ensemble member (they can differ per member)
DUSCHEME=2

# 0 NMMB default with viscous sublayer
# 1 no viscous sublayer (only applies for NMMB default dust scheme)
VSLAYER=0

# soil moisture correction for threshold friction velocity in DUSCHEMES 0-6 (DUSCHEME 7 has different treatment)
# 0 default (2 for DUSCHEME 0; 1 for DUSCHEMES 1-2; 2 for DUSCHEME 3; 3 for DUSCHEMES 4-6)
# 1 Belly (1964)/Ginoux et al. (2001)
# 2 Fecan et al. (1999) - grav. soil moisture, fixed coefficients (Zender et al., 2003, Perez et al., 2011)
# 3 Shao and Jung (2000), Klose et al. (2014) - vol. soil moisture, soil-texture dependent coefficients
SMCCOR=0

# 0 no drag partition scheme in the emission
# 1 drag partition forllowing Marticorena with X parameter = 10.
# 2 drag partition forllowing Marticorena with X parameter = 12255.
# 3 drag partition forllowing Marticorena with X parameter = 40.
# 4 drag partition following Raupach 1993 (automatically chosen for DUSCHEME >= 4) 
#   [vegetation fraction product determined by DMASK: DMASK=3-4 -> new Guerschman vegetation; else -> USGS climatology]
DRAG_PART=4

# 0 apply drag partition to ustt
# 1 apply drag partition to ust
USTDP=0

# 0 default dust extinction (spherical particles) 
# 1 dust extinction assuming tri-axial spheroids
DEXT=0

#-----------------------------------------------------------------------
#CALCULATE NUMBER OF BINS BASED ON SOURCE CHOICE
#-----------------------------------------------------------------------

# Number of dust transport bins: 0 (No dust) or 8
NDUST = 8

# Number of sea salt tranport bins (only 8 works)
NSALT = 8

# Number of organic matter transport bins (only 2,7,6 works - hydrophobic/hydrophilic)
# 1:POM phob., 2:POM phil., 3:Dentener SOA phob. or not used in Tsigaridis SOA .or. ISOA
# 4:Dentener SOA phil. or Tsigaridis SOA ISOPP1A .or. TSOA, 5:Tsigaridis SOA ISOPP2A .or. FSOA
# 6:Tsigaridis SOA APIN1A .or. ASOA, 7:Tsigaridis SOA APIN2A
NOM = 6

# Number of black carbon transport bins (only works 2 - hydrophobic/hydrophilic)
NBC = 2

# Number of sulphate transport bins (only works 1 - bulk SO4 aerosol)
NSO4 = 1

# Number of nitrate transport bins (not active - 3?)
NNO3 = 3

# Number of ammonium transport bins (not active - 1?)
NNH4 = 1

# Number of unspeciated/tagged matter transport bins (works 0,2(fine/coarse) or 5(with ecff-ecwb-tpmfire))
NUNSPC = 5

# Number of pollen bins (1:Birch, 2:Olive, 3:Alder, 4:Ragweed, 5:Grass, 6:Mugwort_type1, 7:Mugwort_type2, 8:Mugwort_type3, 9:Mugwort_type4, 10:Mugwort_type5)
NPOL = 10

# Chemical mechanism
# 0 no gas chemistry
# 1 CB-IV chemical mechanism from KPP 32(gases)
# 2 CBM05 chemical mechanism from KPP 53(gases)
# 22 CBM05 chemical mech. with EBI-solver from CMAQ 53(gases)
# 3  CBM05+NH3 chemical mech. with EBI-solver from CMAQ 73(gases)
# 4 gas tracer 1=1(aero)
# 6 SU-SOA-GLOBAL MECHANISM 40=16(du_ss)+10(om_bc_su)+14(gas)
# 7 NH4-NO3-SO4-SOA-GLOBAL MECHANISM 44=16(du_ss)+10(om_bc_su)+4(no3_nh4)+xx(gases)
# 37 CBM05+MECH_7_AERO7-SU-NI 110=78(gases)+32(aerosols_bin du=8 ss=8 om=7 bc=2 su=1 ni=3 nh4=1 unsp=2)
# 37 with tagging CBM05+MECH_7_AERO7-SU-NI 113=78(gases)+35(aerosols_bin du=8 ss=8 om=7 bc=2 su=1 ni=3 nh4=1 unsp=5_ecff_ecwb_tpmfire)
# 38 CBM05+NH3+SOAP+SU-NO3-NH4-SimpleSOA 112=78(gases)+34(aerosols_bin du=8 ss=8 om=6 bc=2 su=1 ni=3 nh4=1 unsp=5_fineunsp_ecff_ecwb_coarseunsp_tpmfire)
CHEM_MECH = 38

# Sum of all chem/aero tracers (number of bins per mineral x nmin+chem+naero). DO NOT LEAVE EMPTY.
#   :  42 -> mech6  DU-SS-OA-BC-SU GLOBAL MECHANISM 42=16(du_ss)+10(om_bc_su_unspc)+14(gas)
#   :  46 -> mech7  DU-SS-OA-BC-SU-NI GLOBAL MECHANISM 46=16(du_ss)+17(om_bc_su_ni_nh4_unspc)+13(gases)
#   : 110 -> mech37 CB05+DU-SS-OA-BC-SU-NI 110=78(gases)+32(aerosols_bin)
#   : 113 -> mech37 with tagging (ecff_ecwb_or_ectot_ecres_and_tpmfire) CB05+DU-SS-OA-BC-SU-NI+tagging 113=78(gases)+35(aerosols_bin)
#   : 112 -> mech38 with tagging (ecff_ecwb_or_ectot_ecres_and_tpmfire) CB05+DU-SS-OA_simpleSOA-BC-SU-NI+tagging 112=78(gases)+34(aerosols_bin)
#   : 122 -> mech38 with tagging (ecff_ecwb_or_ectot_ecres_and_tpmfire) CB05+DU-SS-OA_simpleSOA-BC-SU-NI+tagging 122=78(gases)+34(aerosols_bin)+10(pollen_aerosols)
#   : 19  -> mech4 only pollen 19=8(DU)+10(pollen_aerosols)+1(dummy_tracer)
NCHEM=122

#-----------------------------------------------------------------------
# DUST MINERALOGY OPTIONS
# If activated, nminerals x nbins has to be added to NCHEM
#-----------------------------------------------------------------------
# Flag to select mineralogy dataset
# 0 dust 
# 1 dust mineralogy from Claquin-1999 soil dataset 
# 2 dust mineralogy from Journet-2014 soil dataset
# 20 dust mineralogy from Journet-2014 soil dataset not-normalized
MINE=0

# we have 3 different emission methods: 51,52,53 
# so far only method 51 for Claquin and Journet is available
EMM=51

# AEROSOL_COMPONENTS:
# In order to select the specific minerals to model the user needs to specify
# mineral_name(nbins) in a text list (STRING).
# NONE always with MINE=0
# For MINE=1 (Claquin), the user can select:
## 'quartz(8),illite(8),kaolinite(8),calcite(8),montmorillonite(8),feldspar(8),irox(8),gypsum(8),dust(8),mixedironox(8)'
# For MINE=2 (Journet), the user can select:
## 'quartz(8),illite(8),kaolinite(8),calcite(8),montmorillonite(8),feldspar(8),irox(8),gypsum(8),dust(8),mixedironox(8),chlorite(8),vermiculite(8),hematite(8),goethite(8),mica(8),hemamix(8),goetmix(8)'
# For MINE=20 (Journet, not normalized), the user can select the same minerals as in MINE=2, plus other(8).
## NOTE: with MINE=2 or MINE=20 (Journet), if irox is selected the sum of goethite and hematite will be considered. Recommended setting is to trace hematite,goethite and hemamix, goetmix separately.
## NOTE2: the MONARCH REDUCE namelist has to consider the order in which the minerals are specified here.
AEROSOL_COMPONENTS=NONE

#-----------------------------------------------------------------------
#SELECT FLAGS FOR ARI: vobiso2018
#-----------------------------------------------------------------------

# flag for ARI module (mdlari in configfile)
#   : 0 -> OPAC climatology
#   : 3 -> MONARCH dynamic coupling
XMDL=0

# flag for multiple call (mlcari in configfile)
#   : 0 -> no DRE
#   : 1 -> DRE of all types
#   : 2 -> DRE of single types (alone) + all types
#   : 3 -> DRE of single types (missing) + all types
XMLC=0

# flag for optical table (tblari in configfile)
#   : 1 -> OPAC refractive indices (homogeneous dust components)
#   : 2 -> OPAC refractive indices + emission p50 for dust imaginary index in (0.25-2.00)µm
#   : 3 -> mineral refractive indices: external mixing
#   : 4 -> mineral refractive indices: internal mixing for hematite-clays (Maxwell-Garnett mixing rule)
XTBL=1

# flag for shape (only for XTBL=1 or XTBL=2)
#   : 0 -> spheres
#   : 1 -> tri-axial spheroids for dust in (0.25-2.00)µm
# DEXT controls the shape of the aerosol for the diagnostics, check it for consistency
XKOK=0

#-----------------------------------------------------------------------
# Time Configuration
#-----------------------------------------------------------------------
# ** Start date is located in expdef_EXPID.conf **
# Choose the time of initial input data & start hour of the forecast (hours at leats two digits: 00 or 03 or 12 or ...)
HOUR			= 12
# Hours of spinup chemistry/aerosols
SPINUP			= 12
# Length of the forecast (hours)
NHOURS			= 36
# History init previous day timestep (for couple dust, next run)
NHOURS_INIT		= 36
# Frequency of history output (up to 552 hours)
HIST 			= 1
# Frequency of boundary condition update for REGIONAL (hours)
BOCO			= 6
# Initial condition analysis files (GFS/FNL/ERA/ERA5/IFS/GEFSAN[00..20]) for each ensemble member (they can differ per member):
TYPE_GFSINIT	= IFS
# GEFS initial condition files (GFS/FNL)
TYPE_GEFSINIT	= FNL
# GFS/FNL/GEFSAN degree resolution (0p25, 0p50, 1p00) - Global longitude-latitude grid files (analysis, initial condition files)
GFS_DEGREE_RES 	= 0p50
# IFS degree resolution (0p125_W80_E100_S0_N80) - Regional longitude-latitude grid files W80_E100_S0_N80 (analysis, initial condition files)
IFS_DEGREE_RES  = 0p125_12_W80_E100_S0_N80
# Is this a forecast run? (true/false)
FCST = true
# Boundary condition chemistry (CAMS_PL/CAMS_ML/CAMS_PL_VRA/CAMS_ML_VRA/CAMS50/CAMS/MOZART) - if no chemistry leave it empty
TYPE_BCCHEM     = CAMS_ML

#-----------------------------------------------------------------------
# Config file for compilation (use the one that is suitable for the host)
#-----------------------------------------------------------------------
# Select whether libs should be compiled or not (0=no/1=yes)
COMPILE_LIBS = 0
# Select profile among the supported platforms in nceplibs compile script
NCEPLIBS_CONFIG = 5
# Compile the CAMP chemistry module? (0=no/1=yes)
# (To solve chemistry with CAMP, do_camp in the job template must be set to true)
DO_CAMP = 0
# CAMP chemistry mechanism folder (in MODEL/NAMELISTS/camp)
# (Only used when DO_CAMP = 1)
CAMP_FOLDER = mod37 
# NPS compilation - Select architecture (17=nord3, 18=mn4)
NPS_CONFIG = 18

#-----------------------------------------------------------------------
# Couple dust
#-----------------------------------------------------------------------
# Couple dust for the next chunk (0/1)
COUPLE_DUST 	= 1
# Couple dust from the beginning (0/1)
# Remember to remove the DELAY = 1 attribute on the HERMES job when enabling COUPLE_DUST_INIT
COUPLE_DUST_INIT= 0
# Couple soil variables (0/1). Works with COUPLE_DUST 0 or 1. It allows recycling soil variables from previous run. Warning: it does not work with binary files. 
RECYCLE_SOIL= 0
# Couple soil variables from the beggining (0/1).
RECYCLE_SOIL_INIT =0

# First chunk initialisation path with previous spinup history file
# please make sure that in an ensemble config the subdirectories names in this path must match the MEMBERS list (in expedf.conf)
SPINUP_FOLDER = /gpfs/archive/bsc32/esarchive/exp/monarch/EXPID/original_files/

# Select IC of chemistry for run with COUPLE_DUST_INIT=0
# 0. IC from ideal conditions
# 1 initialize from a previous run
# 2 initialize from inca chem data
# 3 initialize from global nmmb-ctm run for regional
# 4 initialize from a previous run of different resolution
INIT_CHEM = 1

# How often (number of days) the history_INIT files are kept in /esarchive
SPINUP_SAVE_FREQ = 30

#-----------------------------------------------------------------------
# ONLY_PREVAR_DUST mode: Output folder for monarch preprocess output files
#-----------------------------------------------------------------------
# Root folder from where to construct archiving path
#PREVAR_FOLDER_ARCHIVE = ${SPINUP_FOLDER}/original_files/prevar/
PREVAR_FOLDER_HPC =

#-----------------------------------------------------------------------
# Initial condition analysis folder (without trailing slash! (/))
#-----------------------------------------------------------------------
# ** _HPC for files already on the remote machine **
# ** _REMOTE for files that has to be moved on HPC remote machine **
# GFS files root folder
GFS_FOLDER_ARCHIVE = /gpfs/archive/bsc32/esarchive/recon/ncep/gfs/original_files
GFS_FOLDER_HPC     =
# FNL files root folder
FNL_FOLDER_ARCHIVE = /gpfs/archive/bsc32/esarchive/recon/ncep/ds083.2/original_files
FNL_FOLDER_HPC     =
# ERA-Interim files root folder
ERA_FOLDER_ARCHIVE = /gpfs/archive/bsc32/esarchive/recon/ecmwf/erainterim-monarch/original_files
ERA_FOLDER_HPC     = /gpfs/projects/bsc32/models/monarch/data/initial/era-interim
# ERA5 files root folder
ERA5_FOLDER_ARCHIVE = /gpfs/archive/bsc32/esarchive/recon/ecmwf/era5/original_files
ERA5_FOLDER_HPC     =
# IFS-fcst files root folder
IFS_FOLDER_ARCHIVE  = /gpfs/archive/bsc32/esarchive/exp/ecmwf/ifs/original_files
IFS_FOLDER_HPC      =
# MERRA2 files root folder
MERRA2_FOLDER_ARCHIVE = /gpfs/archive/bsc32/esarchive/recon/nasa/merra_v2/original_files/i584 
MERRA2_FOLDER_HPC   =
# GEFS ANalyses files root folder
GEFSAN_FOLDER_ARCHIVE = /gpfs/archive/bsc32/esarchive/recon/ncep/gefs/original_files/fnl_format/original_files
GEFSAN_FOLDER_HPC     =
# CAMS files root folder
CAMS_FOLDER_ARCHIVE   = /gpfs/archive/bsc32/esarchive/recon/ecmwf/cams_nrealtime/original_files/fc_mc_pl_oper_ecmf
CAMS_FOLDER_HPC       = 
# CAMS50 files root folder
CAMS50_FOLDER_ARCHIVE   = /gpfs/archive/bsc32/esarchive/recon/ecmwf/cams_nrealtime/original_files/fc_mc_pl_oper_ecmf
CAMS50_FOLDER_HPC       = 
# CAMS_PL files root folder
CAMS_PL_FOLDER_ARCHIVE   = /gpfs/archive/bsc32/esarchive/recon/ecmwf/cams_global_nrealtime/original_files/0p40_12
CAMS_PL_FOLDER_HPC       =
# CAMS_ML files root folder
CAMS_ML_FOLDER_ARCHIVE   = /gpfs/archive/bsc32/esarchive/recon/ecmwf/cams_global_nrealtime/original_files/ml/ftp
CAMS_ML_FOLDER_HPC       =
# CAMS_ML_VRA files root folder
CAMS_ML_VRA_FOLDER_ARCHIVE   = /gpfs/archive/bsc32/esarchive/recon/ecmwf/cams_global_analysis/original_files/cams_ml_vra
CAMS_ML_VRA_FOLDER_HPC       =
# CAMS_PL_VRA files root folder
CAMS_PL_VRA_FOLDER_ARCHIVE   = /gpfs/archive/bsc32/esarchive/recon/ecmwf/cams_global_analysis/original_files/0p75
CAMS_PL_VRA_FOLDER_HPC       =
# MOZART files root folder
MOZART_FOLDER_ARCHIVE = /gpfs/archive/bsc32/esarchive/recon/ucar/mozart/original_files
MOZART_FOLDER_HPC     = /gpfs/scratch/bsc32/bsc32771/tmp/PREPARE_REGIONAL_RUNS/DATA_required/BC-MOZART

#-----------------------------------------------------------------------
# Output folder for archive (without trailing slash! (/))
#-----------------------------------------------------------------------
# Root folder from where to construct archiving path
ARCHIVE_ROOT_FOLDER		= /gpfs/archive/bsc32/esarchive/exp

#-----------------------------------------------------------------------
# DT machines usage
#-----------------------------------------------------------------------
# Enable/disable use of DT machines for file transfers (TRUE/FALSE)
USE_DT_COMMANDS	= TRUE

#-----------------------------------------------------------------------
# STATIC data folders (without trailing slash! (/))
#-----------------------------------------------------------------------
# Absolute path at HPC that contains the shared Static data folder (created by hand)
#Leave it blank if you want to copy all Static data from repo to your experiment
STATIC_HPC_FOLDER	= /gpfs/projects/bsc32/models/monarch/data/static
STATIC_HPC_FOLDER_NPS   = /gpfs/projects/bsc32/models/monarch/data/static_v2.0
# Local NAS repository folder (e.g.: /esnas/exp/nmmb-bsc-ctm_v2.0.4/constant)
CONSTANT_REPO_FOLDER	= /gpfs/archive/bsc32/esarchive/exp/monarch/static
CONSTANT_REPO_FOLDER_NPS = /gpfs/archive/bsc32/esarchive/exp/monarch/static_v2.0

#-----------------------------------------------------------------------
# CHEM CONFIGURATION (REGIONAL AND GLOBAL AEROSOLS)
#-----------------------------------------------------------------------
# Folders on HPC! (TODO: will be moved to esarchive?)
DATAMEGAN = /gpfs/projects/bsc32/models/monarch/data/static/emissions/DATA_megan_v2.04

# Climatologies for global runs - GLOBAL_AEROSOLS
CHEMIC          = 

[da]
# DUST_DA CONFIGURATION
# Domain decomposition. Remember that (NPROC_LON * NPROC_LAT) must be the same number of procs required in jobs.conf!
NPROC_LON = 16
NPROC_LAT = 16

# radius of influence of the observations
NPATCH = 20

# step between model output (hours) (Usually the same as Frequency of history output)
DA_IOSTEP		= 3
# time loop
MIN_SLOT = -7
MAX_SLOT = 0
# time step in the MONARCH output we want to ignore
# (i.e the first time step with no information)
IGNORE_TS = 1

# horizontal localization
LOCSIG_HOR = 10.0
# vertical localization
LOCSIG_VER = 1.0
# temporal localization
LOCSIG_TEMP = 3.0
# vertical extent (<=nlevg)
MAXILEVE = 38

INFLATION = 0.0
QC = 1.4

# Exclude the last n members from the computation
EXCLUDE_NMEM=0

# DA write options (F=disable/T=enable)
OVERWRITE_RESTART = T
WRITE_RESTART_MEAN = F
WRITE_OUT_MEMBERS = T
WRITE_OUT_MEAN    = F

# Preprocessed observations folders
DA_FOLDER_ARCHIVE =
DA_FOLDER_HPC     = /gpfs/projects/bsc32/bsc32137/LETKFSP/PREOBS/obs_2012_DB_PG01rotBC-2gt02_fullyear/

[obs_preproc]
# Observation preprocessor configuration
# Type of the observations to preprocess (in-situ/VIIRS-aod)
OBS_PREPROC = in-situ
# Path to the data
DATA_DIR = /esarchive/obs/ecmwf/eea-cams50/original_files/
# Type of observation files: ANALYSIS(an) or REANALYSIS(re)
OBS_FILE_TYPE = re
# Uncertainty constants
# For in-situ: Error = obs_value * uncb + uncc
# For VIIRS-aod: Error = sqrt((unca*AOD + uncb)**2 + uncc)
UNC_CONST_A = 0.2
UNC_CONST_B = 0.01
UNC_CONST_C = 0.0001

## in-situ
# Path to the stations information
STATIONS_DIR = /esarchive/obs/ecmwf/eea-cams50/original_files/stations/
# Element(s) to process (list). Allowed options: CO, NO2, O3, PM10, PM25, SO2
ELEMENT = O3
# Save all observations in the same file: t(True) f(False)
SAVE_ALL_OBS_IN_ONE = t

## VIIRS-aod
# Rotate coordinates (true/false)
ROTATE = true

[hermes]
# HERMESv3 configuration
DO_HERMES_GR      = 1 0 0
DO_HERMES_BU      = 0 0 0
# The name of the HERMESv3 config file without .conf. It must be inside auto-monarch/conf/hermes. It can be a vector of files per member.
HERMES_CONF = HERMESv3_camsregv42_ref21_taggingv2_sindhant_000
# The name of the EI_configuration file without .csv or _noESP.csv. It must be inside auto-monarch/conf/hermes. It can be a vector of files per member.
HERMES_EI_CONF = EI_configuration_camsregv42_ref21_taggingv2_sindhant_gfashourly_000
# HERMES temporal resolution of anthropogenic emissions ('hourly','daily','monthly','yearly'/ only works hourly)
# Not used in HERMES SIMs but in MONARCH SIM
HERMES_ANTHRO_RES = 'hourly'

# Add wild fire emissions? (true/false) TODO: Implement the hourly GFAS option
DO_GFAS = true
# GFAS temporal resolution ('daily','hourly')
GFAS_RES = 'hourly'
# ** _HPC for files already on the remote machine **
# ** _REMOTE for files that has to be moved on HPC remote machine **
# GFAS files root folder
GFAS_FOLDER_DAILY_ARCHIVE = /gpfs/archive/bsc32/esarchive/recon/ecmwf/gfas/daily_mean/multivar/
GFAS_FOLDER_DAILY_HPC     =
GFAS_FOLDER_HOURLY_ARCHIVE = /gpfs/archive/bsc32/esarchive/recon/ecmwf/gfas/1hourly/multivar/
GFAS_FOLDER_HOURLY_HPC     =

# if new domain use HERMES_AUXFILES = /gpfs/projects/bsc32/models/hermesv3/country_masks, the first run of hermes will prepare static data
# if already existing domain use, i.e., HERMES_AUXFILES = /gpfs/projects/bsc32/models/hermesv3/monarch_caliope_0.2
HERMES_AUXFILES = /gpfs/projects/bsc32/models/hermesv3/country_masks
# static anthropogenic databases for HERMES
HERMES_DATA = /gpfs/projects/bsc32/models/hermesv3/data
# perturbation factors for HERMES outputs
# path to a netCDF file with the perturbation factors. must contain a level for each member.
HERMES_PERTURBATION_FACTORS_FILE = /gpfs/projects/bsc32/models/monarch/data/static/DA/perturbations_hermes_gfas/perturb2D_sd0p5_xycor10.nc

# Precomputed HERMESv3 files. If empty, HERMESv3 will create the files. TODO: Not working yet.
AE_FOLDER_HPC =
AE_FOLDER_ARCHIVE =

[reduce]
# REDUCE CONFIGURATION
# Root directory in which the reduced files will be created (cannot be empty).
# The final path will be <REDUCE_OUTPUT_DIRECTORY>/monarch/<EXPID>.
REDUCE_OUTPUT_DIRECTORY = /gpfs/scratch/$(id -gn)/$(whoami)
# Configuration file for REDUCE
# It must be present in the REDUCE repository or added in the local copy of the repository cloned in sources
REDUCE_CSV_FILE = monarch_reduce_REGIONAL_CHEM.csv.cams2_40_final
# Don't archive the original files and remove them in CLEAN (0/1)
REMOVE_ORIGINAL_FILES = 1

[it]
# Specify the name of one or more config file placed in the conf/it folder. If a list of config files is provided, the autosubmit SPLIT option has to be used.
# File extension (.conf) and/or suffix (see below) will be added by the template based on the TASKTYPE value.
# If multiple IT jobs are run (e.g. IT_V, IT_H), the file names must contain a suffix indicating the type of the interpolation using the following convention (TASKTYPE => file name):
# - IT => IT_CONF_FILE.conf
# - IT_V => IT_CONF_FILE.vert.conf
# - IT_H => IT_CONF_FILE.horiz.conf
# - IT_H_POINTS => IT_CONF_FILE.points.conf
# NOTE: the paths of the input/output files will be build by the template using the current experiment paths. See the it.conf.tmpl file to create a new config file.
IT_CONF_FILE = it.CAMS2_40
# Read MONARCH original files directly instead of reduced files (0/1)
IT_READ_ORIGINAL_FILES = 0
# Don't archive reduced files and remove them in CLEAN (0/1)
REMOVE_REDUCED_FILES = 0

#-----------------------------------------------------------------------
# NON-STANDARD ENSEMBLE PERTURBATIONS
#-----------------------------------------------------------------------

#-----------------------------------------------------------------------
# Calibration factors for  multischeme  (only if DUSCHEME=100)
# if DUSCHEME=100, these factors are used and DCAL is ignored.
# one DCALGRP by dust configuration (group)
#-----------------------------------------------------------------------
DCALGRP0 = 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000
DCALGRP1 = 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000
DCALGRP2 = 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 
DCALGRP3 = 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 
DCALGRP4 = 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 
DCALGRP5 = 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 
DCALGRP6 = 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 
DCALGRP7 = 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 
DCALGRP8 = 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 
DCALGRP9 = 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 

#-----------------------------------------------------------------------
# Factors for multischeme (only if DUSCHEME=100)
# one DFACTORSCHEME by dust group
#-----------------------------------------------------------------------

DFACTORGRP0 = 0.632966 0.142281 0.934184 0.484760 0.844017 0.242981 0.054468 0.411579 0.263087 0.811417 0.237840 0.713804 0.407194 0.213142 0.714807 0.090088 0.858099 0.937137 0.910781 0.427386
DFACTORGRP1 = 0.367034 0.857719 0.065816 0.515240 0.155983 0.757019 0.945532 0.588421 0.736913 0.188583 0.762160 0.286196 0.592806 0.786858 0.285193 0.909912 0.141901 0.062863 0.089219 0.572614
DFACTORGRP2 = 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000
DFACTORGRP3 = 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000
DFACTORGRP4 = 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000
DFACTORGRP5 = 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000
DFACTORGRP6 = 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000
DFACTORGRP7 = 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000
DFACTORGRP8 = 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000
DFACTORGRP9 = 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000

# Only for DUSCHEME=100 :  definitions of dust emission groups: each element of the group can be seen as a tuple (duscheme, src, dmask, drag_part).
# It is prepared to a max of 10 groups. The 10 tuples are defined below in columns:
# dust scheme : from DUSCHEME options. Only tested with DGRPSCHEME=1 . 
DGRPSCHEME   = 0 1 3 1 1 1 1 1 1 1
# SRC : (Only prepared with no anthropogenic tagging : SRC <7). Only tested with 1 and 3 .
DGRPSRC      = 3 3 3 3 3 3 3 3 3 3
# DRAG_PART : Only tested with 3 and 4. 
DGRPDRAGPART = 3 3 3 3 3 3 3 3 3 3
# DMASK : (Only prepared for use with climatologies DMASK: options 2 or 4 ). Only tested with 2 and 4. 
DGRPMASK     = 2 2 2 2 2 2 2 2 2 2

# End definitions for DUSCHEME=100

# Map perturbations of dust emission (only works with NPS, all DUSCHEMEs)
# Maps are 2D fields of gaussian noise with mean 0 and std=1. They can have different correlation lenght. 
# If they are activated, dust emissions are perturbed by emis = max(emis*(1+map*PERTMAPSTD),0)
# use (1) or not (0) these maps:
PERTMAP = 0 
# netcdf with the perturbation maps at any regular lat-lon resolution (eg, 0.25deg), in [-180,180] and [-90,90] range (including bounds). It could be located in HPC or ARCHIVE.
PERTMAPFILE=/gpfs/projects/bsc32/bsc32417/LETKFSP/PERTMAPS/pert_25x250km_0p25deg_p9.nc 
# number of map of the netcdf file (starting at 1, dimension "numberpert") and standard deviation of the perturbation (vector by member):
PERTMAPNUMBER = 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 
PERTMAPSTD= 0.2 0.2 0.2 0.2 0.2 0.2 0.2 0.2 0.2 0.2 0.2 0.2 0.2 0.2 0.2 0.2 0.2 0.2 0.2 0.2 0.2 
# end definitions map perturbations

[CAMS2_40]
# Operational FTP server
FTP_HOST = transmet-internet-gateway.meteo.fr
FTP_USER = cams50_mona_int
FTP_PASSWD = TT22bbPP
# Backup FTP server
FTP_HOST_BACKUP = ftp.meteo.fr
FTP_USER_BACKUP = MONARCH
FTP_PASSWD_BAKCUP = Uruvaimaem6j