[LOCAL_SETUP]
FILE = templates/common/localsetup.tmpl.sh
PLATFORM = LOCAL
CHECK = true
RETRIALS = 1

[SYNCHRONIZE]
FILE = templates/common/synchronize.tmpl.sh
PLATFORM = transfer_node
DEPENDENCIES = LOCAL_SETUP
CHECK = true

[REMOTE_SETUP]
FILE = sources/runtime/autosubmit/compilation.sh
DEPENDENCIES = SYNCHRONIZE
WALLCLOCK = 2:00
PROCESSORS = 4
CUSTOM_DIRECTIVES = ["#SBATCH -p interactive"]
CHECK = true

[INI]
FILE = templates/common/ini.tmpl.sh
DEPENDENCIES = REMOTE_SETUP
RUNNING = member
WALLCLOCK = 00:30
CUSTOM_DIRECTIVES = ["#SBATCH -p interactive"]
CHECK = true
#QUEUE = debug

[SIM]
FILE = sources/runtime/autosubmit/ece-esm.sh
DEPENDENCIES = INI SIM-1 CLEAN-26 NCTIME-26
#DEPENDENCIES = INI SIM-1 CLEAN-3 NCTIME-3
RUNNING = chunk
WALLCLOCK = 2:00
PROCESSORS = 768
TASKS = 48
THREADS = 1
CHECK = on_submission
QUEUE = debug

[CMOROCE]
FILE = templates/common/cmoroce.tmpl.sh
DEPENDENCIES = SIM
WALLCLOCK = 0:15
RUNNING = chunk
TASKS = 8
CUSTOM_DIRECTIVES = ["#SBATCH --exclusive"]
CHECK = true
#QUEUE = debug

[CMORATM]
FILE = templates/common/cmoratm.tmpl.sh
DEPENDENCIES = SIM SIM+1
WALLCLOCK = 0:15
RUNNING = chunk
CUSTOM_DIRECTIVES = ["#SBATCH --exclusive"]
CHECK = true
#QUEUE = debug

[CMORLPJG]
FILE = templates/common/cmorlpjg.tmpl.sh
DEPENDENCIES = SIM
WALLCLOCK = 0:20
RUNNING = chunk
CUSTOM_DIRECTIVES =  ["#SBATCH --exclusive"]
CHECK = true
#QUEUE = debug

[POST]
FILE = templates/common/post.tmpl.sh
DEPENDENCIES = CMORATM CMORATM+1 CMOROCE CMORLPJG SAVEIC SIM SIM+1 POST-1
RUNNING = chunk
WALLCLOCK = 00:30
# when using the classic outclass make sure you are running POST in exclusive mode (for MN4): CUSTOM_DIRECTIVES = ["#SBATCH --exclusive"]
CUSTOM_DIRECTIVES = ["#SBATCH --exclusive"]
CHECK = true
#QUEUE = debug

[CLEAN]
FILE = templates/common/clean.tmpl.sh
PLATFORM = transfer_node
DEPENDENCIES = POST SIM SIM+1 CMOROCE CMORATM CMORATM+1 CMORLPJG CLEAN-1
RUNNING = chunk
WALLCLOCK = 00:30
CHECK = true

[EARTHDIAGS]
FILE = templates/common/earthdiags.tmpl.sh
PLATFORM = nord3v2
DEPENDENCIES = CLEAN
RUNNING = chunk
WALLCLOCK = 02:00
CUSTOM_DIRECTIVES = ["#SBATCH --exclusive"]
CHECK = true
NOTIFY_ON = FAILED

[SAVEIC]
FILE = templates/common/saveic.tmpl.sh
DEPENDENCIES = SIM
RUNNING = chunk
WALLCLOCK = 02:00
CHECK = true
THREADS = 6
#QUEUE = debug

[CLEAN_MEMBER]
FILE = templates/common/clean_member.tmpl.sh
PLATFORM = transfer_node
DEPENDENCIES = CLEAN PERFORMANCE_METRICS SAVEIC
RUNNING = member
WALLCLOCK = 02:00
CHECK = true

[PERFORMANCE_METRICS]
FILE = templates/common/performance_metrics.tmpl.sh
DEPENDENCIES = CLEAN
RUNNING = once
PROCESSORS = 1
PLATFORM = LOCAL
CHECK = true

[TRANSFER_MEMBER]
FILE = templates/common/transfer_member.tmpl.sh
PLATFORM = transfer_node
DEPENDENCIES = CLEAN_MEMBER
RUNNING = member
CHECK = true

[NCTIME]
FILE = templates/common/nctime.tmpl.sh
PLATFORM = nord3v2
DEPENDENCIES = NCTIME-1 CLEAN CLEAN-1 CLEAN-2 CLEAN-3 CLEAN-4 CLEAN-5 CLEAN-6 CLEAN-7 CLEAN-8 CLEAN-9
#DEPENDENCIES = NCTIME-1 CLEAN CLEAN-1 CLEAN-2
RUNNING = chunk
FREQUENCY = 10
#FREQUENCY = 3
PROCESSORS = 16
WALLCLOCK = 2:00

