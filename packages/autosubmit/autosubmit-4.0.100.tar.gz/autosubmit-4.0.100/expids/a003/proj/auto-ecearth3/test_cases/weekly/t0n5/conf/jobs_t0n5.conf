[LOCAL_SETUP]
FILE = templates/localsetup.tmpl.sh
PLATFORM = LOCAL
CHECK = true
NOTIFY_ON = FAILED

[SYNCHRONIZE]
FILE = templates/synchronize.tmpl.sh
PLATFORM = transfer_node
DEPENDENCIES = LOCAL_SETUP
CHECK = true
NOTIFY_ON = FAILED
WALLCLOCK = 0:30

[REMOTE_SETUP]
FILE = sources/runtime/autosubmit/compilation.sh
DEPENDENCIES = SYNCHRONIZE
WALLCLOCK = 2:00
PROCESSORS = 4
CUSTOM_DIRECTIVES = ["#SBATCH -p interactive"]
CHECK = true
NOTIFY_ON = FAILED

[INI]
FILE = templates/ini.tmpl.sh
DEPENDENCIES = REMOTE_SETUP
RUNNING = member
WALLCLOCK = 00:30
QUEUE = debug
CHECK = true
NOTIFY_ON = FAILED

[SIM]
FILE = sources/runtime/autosubmit/ece-esm.sh
DEPENDENCIES = INI SIM-1 CLEAN-3 NCTIME-3
RUNNING = chunk
WALLCLOCK = 1:30
PROCESSORS = 144
THREADS = 1
CHECK = on_submission
QUEUE = debug
NOTIFY_ON = FAILED


[CMORATM]
FILE = templates/cmor.tmpl.sh
DEPENDENCIES = SIM SIM+1
WALLCLOCK = 2:00
RUNNING = chunk
NOTIFY_ON = FAILED
CUSTOM_DIRECTIVES = ["#SBATCH --exclusive"]
QUEUE = debug
CHECK = true
PLATFORM = nord3v2



[CMORTM5]
FILE = templates/cmor.tmpl.sh
DEPENDENCIES = SIM SIM+1
WALLCLOCK = 2:00
RUNNING = chunk
NOTIFY_ON = FAILED
#CUSTOM_DIRECTIVES = ["#SBATCH --exclusive"]
QUEUE = debug
CHECK = true
PLATFORM = nord3v2

[POST]
FILE = templates/post.tmpl.sh
PLATFORM = nord3v2
DEPENDENCIES = CMORATM CMORATM+1 SAVEIC SIM SIM+1 CMORTM5 POST-1
RUNNING = chunk
WALLCLOCK = 01:00
# when using the classic outclass make sure you are running POST in exclusive mode (for MN4): CUSTOM_DIRECTIVES = ["#SBATCH --exclusive"]
QUEUE = debug
CHECK = true
NOTIFY_ON = FAILED

[CLEAN]
FILE = templates/clean.tmpl.sh
PLATFORM = transfer_node
DEPENDENCIES = CLEAN POST SIM SIM+1 CMORATM CMORATM+1 CMORTM5
SELECT_CHUNKS = CLEAN*[1]*[2:]
RUNNING = chunk
WALLCLOCK = 00:30
CHECK = true
NOTIFY_ON = FAILED

#[EARTHDIAGS]
#FILE = templates/earthdiags.tmpl.sh
#PLATFORM = nord3v2
#DEPENDENCIES = CLEAN
#RUNNING = chunk
#WALLCLOCK = 01:00
#QUEUE = debug
#CHECK = true
#NOTIFY_ON = FAILED

[MONITOR]
FILE = templates/monitor.tmpl.py
PLATFORM = nord3v2
DEPENDENCIES = MONITOR-5 CLEAN ESMVALTOOL EARTHDIAGS
FREQUENCY = 5
RUNNING = chunk
WALLCLOCK = 01:00
CHECK = true
TYPE = python
EXECUTABLE = %PROJDIR%/es-esmvaltool/common-tools/auto-ecearth/nord3v2_launcher
PROCESSORS = 4
NOTIFY_ON = FAILED

[SAVEIC]
FILE = templates/saveic.tmpl.sh
DEPENDENCIES = SIM
RUNNING = chunk
WALLCLOCK = 00:40
CHECK = true
THREADS = 12
QUEUE = debug
NOTIFY_ON = FAILED

[CLEAN_MEMBER]
FILE = templates/clean_member.tmpl.sh
PLATFORM = transfer_node
DEPENDENCIES = CLEAN PERFORMANCE_METRICS SAVEIC
RUNNING = member
WALLCLOCK = 02:00
CHECK = true
NOTIFY_ON = FAILED

[PERFORMANCE_METRICS]
FILE = templates/performance_metrics.tmpl.sh
DEPENDENCIES = CLEAN
RUNNING = once
PROCESSORS = 1
PLATFORM = LOCAL
CHECK = true
NOTIFY_ON = FAILED

[TRANSFER_MEMBER]
FILE = templates/transfer_member.tmpl.sh
PLATFORM = transfer_node
DEPENDENCIES = CLEAN_MEMBER
RUNNING = member
CHECK = true
NOTIFY_ON = FAILED

[NCTIME]
FILE = templates/nctime.tmpl.sh
PLATFORM = nord3v2
DEPENDENCIES = NCTIME-1 CLEAN CLEAN-1 CLEAN-2
RUNNING = chunk
FREQUENCY = 3
CHECK = true
WALLCLOCK = 02:30
NOTIFY_ON = FAILED

[CLEAN_EXPERIMENT]
FILE = templates/clean_experiment.tmpl.sh
DEPENDENCIES = NCTIME TRANSFER_MEMBER MONITOR
PLATFORM = transfer_node
RUNNING = once
WALLCLOCK = 00:30
CHECK = true
NOTIFY_ON = FAILED

