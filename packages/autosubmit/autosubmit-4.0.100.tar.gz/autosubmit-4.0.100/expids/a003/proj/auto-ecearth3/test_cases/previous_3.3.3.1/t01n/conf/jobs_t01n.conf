[LOCAL_SETUP]
FILE = templates/common/common.localsetup
PLATFORM = LOCAL

[REMOTE_SETUP]
FILE = templates/common/common.remotesetup
DEPENDENCIES = LOCAL_SETUP
WALLCLOCK = 02:00
PROCESSORS = 4
CUSTOM_DIRECTIVES = ["#SBATCH -p interactive"]

[INI]
FILE = templates/ecearth3/ecearth3.ini
DEPENDENCIES = REMOTE_SETUP
RUNNING = member
WALLCLOCK = 00:30
CUSTOM_DIRECTIVES = ["#SBATCH -p interactive"]

[SIM]
FILE = sources/runtime/autosubmit/ece-ifs+nemo.sh
DEPENDENCIES = INI SIM-1 CLEAN-2
RUNNING = chunk
WALLCLOCK = 01:00
PROCESSORS = 1296 
TASKS = 48
THREADS = 1
CHECK = False

[POST]
FILE = templates/ecearth3/ecearth3.post
DEPENDENCIES = SIM CMORATM1
RUNNING = chunk
WALLCLOCK = 00:30
CUSTOM_DIRECTIVES = ["#SBATCH --exclusive"]

[CMOROCE]
FILE = templates/ecearth3/ecearth3.cmoroce
DEPENDENCIES = SIM
WALLCLOCK = 24:00
RUNNING = chunk
NOTIFY_ON = RUNNING FAILED COMPLETED
CUSTOM_DIRECTIVES =  ["#SBATCH --constraint=highmem", "#SBATCH --cpus-per-task=4", "#SBATCH --tasks-per-node=8"]

[CMORATM1]
FILE = templates/ecearth3/ecearth3.cmoratm1
DEPENDENCIES = SIM
WALLCLOCK = 24:00
RUNNING = chunk
CUSTOM_DIRECTIVES =  ["#SBATCH --constraint=highmem", "#SBATCH --cpus-per-task=4", "#SBATCH --tasks-per-node=8"]
NOTIFY_ON = RUNNING FAILED COMPLETED
THREADS = 8

[CLEAN]
FILE = templates/ecearth3/ecearth3.clean
DEPENDENCIES = POST CMORATM1+1 CMOROCE CMORATM1 
RUNNING = chunk
WALLCLOCK = 00:30

[TRANSFER]
FILE = templates/common/common.localtrans
PLATFORM = LOCAL
DEPENDENCIES = CLEAN
RUNNING = chunk
FREQUENCY = 6
WAIT = true

[LOCALPOST]
FILE = templates/common/common.localpost
PLATFORM = moore
DEPENDENCIES = TRANSFER
RUNNING = chunk
WALLCLOCK = 05:00
FREQUENCY = 6

[PLOT]
FILE = templates/common/common.plot
PLATFORM = moore
DEPENDENCIES = LOCALPOST
RUNNING = chunk
WALLCLOCK = 00:30
FREQUENCY = 6
