[LOCAL_PYTHON_SETUP]
FILE = templates/common/common.localpythonsetup
PLATFORM = LOCAL
TYPE = python

[LOCAL_SETUP]
FILE = templates/common/common.localsetup
DEPENDENCIES = LOCAL_PYTHON_SETUP
PLATFORM = transfer_node

[REMOTE_SETUP]
FILE = sources/runtime/autosubmit/compilation.sh
DEPENDENCIES = LOCAL_SETUP LOCAL_PYTHON_SETUP
WALLCLOCK = 02:00
PROCESSORS = 4
CUSTOM_DIRECTIVES = ["#SBATCH -p interactive"]

[INI]
FILE = templates/ecearth3/ecearth3.ini
DEPENDENCIES = REMOTE_SETUP
RUNNING = member
WALLCLOCK = 00:30
QUEUE = debug

[SIM]
FILE = sources/runtime/autosubmit/ece-ifs+nemo.sh
DEPENDENCIES = INI SIM-1 CLEAN-2
RUNNING = chunk
WALLCLOCK = 12:00
PROCESSORS = 768
TASKS = 48
THREADS = 1
CHECK = False


[POST]
FILE = templates/ecearth3/ecearth3.post
# Please add your correspond dependencies: CMORATM* CMORATM*+1
# CMORATM2 CMORATM2+1 CMORATM3 CMORATM3+1 CMORATM4 CMORATM4+1 CMORATM5 CMORATM5+1 CMORATM6 CMORATM6+1 CMORATM7 CMORATM7+1 CMORATM8 CMORATM8+1 CMORATM9 CMORATM9+1 CMORATM10 CMORATM10+1 CMORATM11 CMORATM11+1 CMORATM12 CMORATM12+1
DEPENDENCIES = SIM CMORATM+1 CMOROCE CMORATM
RUNNING = chunk
WALLCLOCK = 01:00
QUEUE = debug

[CMOROCE]
FILE = templates/ecearth3/ecearth3.cmoroce
DEPENDENCIES = SIM
WALLCLOCK = 1:00
RUNNING = chunk
NOTIFY_ON = RUNNING FAILED COMPLETED
TASKS = 8
QUEUE = debug
# THREADS #
# -- MN4 --
CUSTOM_DIRECTIVES = ["#SBATCH --cpus-per-task=4", "#SBATCH --constraint=highmem" ]
# ---------
# -- CCA --
#THREADS = 4
# ---------


[CMORATM]
FILE = templates/common/common.cmoratm
DEPENDENCIES = SIM
WALLCLOCK = 1:00
RUNNING = chunk
NOTIFY_ON = RUNNING FAILED COMPLETED
TASKS = 8
SPLITS = 12
# THREADS #
# -- MN4 --
CUSTOM_DIRECTIVES = ["#SBATCH --cpus-per-task=4"]
# ---------
# -- CCA --
# THREADS = 4
# ---------
# QUEUE = debug

[CLEAN]
FILE = templates/ecearth3/ecearth3.clean
DEPENDENCIES = POST CMORATM+1 CMOROCE CMORATM
# DEPENDENCIES = POST
RUNNING = chunk
WALLCLOCK = 00:30
QUEUE = debug

[CLEAN_MEMBER]
FILE = templates/ecearth3/ecearth3.clean_member
DEPENDENCIES = CLEAN 
RUNNING = member
WALLCLOCK = 00:10
QUEUE = debug

[TRANSFER]
FILE = templates/common/common.localtrans
PLATFORM = transfer_node
DEPENDENCIES = CLEAN
RUNNING = chunk
FREQUENCY = 6
WAIT = true

[LOCALPOST]
FILE = templates/common/common.localpost
PLATFORM = cte-power
DEPENDENCIES = TRANSFER
RUNNING = chunk
WALLCLOCK = 05:00
FREQUENCY = 6

