[LOCAL_SETUP]
FILE = templates/common/common.localsetup
PLATFORM = transfer_node

[REMOTE_SETUP]
FILE = sources/runtime/autosubmit/compilation.sh
DEPENDENCIES = LOCAL_SETUP
WALLCLOCK = 02:00
PROCESSORS = 4
CUSTOM_DIRECTIVES = ["#SBATCH -p interactive"]

[INI]
FILE = templates/ecearth3/ecearth3.ini
DEPENDENCIES = REMOTE_SETUP
RUNNING = member
WALLCLOCK = 00:30
QUEUE = debug

[SIM]
FILE = sources/runtime/autosubmit/ece-ifs+nemo.sh
DEPENDENCIES = INI SIM-1 CLEAN-2
RUNNING = chunk
WALLCLOCK = 02:00
PROCESSORS = 768
TASKS = 48
THREADS = 1
CHECK = False
QUEUE = debug

[POST]
FILE = templates/ecearth3/ecearth3.post
# Please add your correspond dependencies: CMORATM* CMORATM*+1
# CMORATM2 CMORATM2+1 CMORATM3 CMORATM3+1 CMORATM4 CMORATM4+1 CMORATM5 CMORATM5+1 CMORATM6 CMORATM6+1 CMORATM7 CMORATM7+1 CMORATM8 CMORATM8+1 CMORATM9 CMORATM9+1 CMORATM10 CMORATM10+1 CMORATM11 CMORATM11+1 CMORATM12 CMORATM12+1
DEPENDENCIES = SIM CMORATM1 CMOROCE
RUNNING = chunk
WALLCLOCK = 01:00
QUEUE = debug

[CMOROCE]
FILE = templates/ecearth3/ecearth3.cmoroce
DEPENDENCIES = SIM
WALLCLOCK = 1:00
RUNNING = chunk
NOTIFY_ON = RUNNING FAILED COMPLETED
TASKS = 8
QUEUE = debug
# THREADS #
# -- MN4 --
CUSTOM_DIRECTIVES = ["#SBATCH --cpus-per-task=4", "#SBATCH --constraint=highmem" ]
# ---------
# -- CCA --
#THREADS = 4
# ---------


[CMORATM1]
FILE = templates/common/common.cmoratm
DEPENDENCIES = SIM
WALLCLOCK = 1:00
RUNNING = chunk
NOTIFY_ON = RUNNING FAILED COMPLETED
TASKS = 8
QUEUE = debug
#THREADS #
# -- MN4 --
CUSTOM_DIRECTIVES = ["#SBATCH --cpus-per-task=4"]
# ---------
# -- CCA --
#THREADS = 4
# ---------

[CLEAN]
FILE = templates/ecearth3/ecearth3.clean
DEPENDENCIES = POST CMORATM1+1 CMORATM1 CMOROCE
RUNNING = chunk
WALLCLOCK = 00:30
QUEUE = debug

[CLEAN_MEMBER]
FILE = templates/common/common.clean_member
DEPENDENCIES = CLEAN 
RUNNING = member
WALLCLOCK = 02:30

[TRANSFER]
FILE = templates/common/common.localtrans
PLATFORM = transfer_node
DEPENDENCIES = CLEAN
RUNNING = chunk

[LOCALPOST]
FILE = templates/common/common.localpost
PLATFORM = moore
DEPENDENCIES = TRANSFER LOCALPOST-1
RUNNING = chunk
WALLCLOCK = 05:00

[TRANSFER_MEMBER]
FILE = templates/common/common.transfer_member
PLATFORM = transfer_node
DEPENDENCIES = CLEAN_MEMBER
RUNNING = member

