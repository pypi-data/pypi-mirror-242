[LOCAL_SETUP]
FILE = templates/common/localsetup.tmpl.sh
PLATFORM = LOCAL
CHECK = true

[SYNCHRONIZE]
FILE = templates/common/synchronize.tmpl.sh
PLATFORM = transfer_node
DEPENDENCIES = LOCAL_SETUP
CHECK = true

[REMOTE_SETUP]
FILE = sources/runtime/autosubmit/compilation.sh
DEPENDENCIES = SYNCHRONIZE
WALLCLOCK = 2:00
PROCESSORS = 4
CUSTOM_DIRECTIVES = ["#SBATCH -p interactive"]
CHECK = true

[INI]
FILE = templates/common/ini.tmpl.sh
DEPENDENCIES = REMOTE_SETUP
RUNNING = member
WALLCLOCK = 00:30
#! QUEUE = debug
CHECK = true

[SIM]
FILE = sources/runtime/autosubmit/ece-lsm.sh
DEPENDENCIES = INI SIM-1 CLEAN-3 NCTIME-3
RUNNING = chunk
WALLCLOCK = 1:00
#PROCESSORS = 96
TASKS = 48
THREADS = 1
#CHECK = on_submission
#! QUEUE = debug

#osm - set LPJG=FALSE and OSM=TRUE !!!
#PROCESSORS = 1
#CUSTOM_DIRECTIVES = ["#SBATCH --exclusive", "#SBATCH --cpus-per-task=24"]
#QUEUE = debug

#lpjg - set LPJG=TRUE and OSM=FALSE !!!
#PROCESSORS = 96
#QUEUE = debug


#lpjg+osm - set LPJG=TRUE OSM=TRUE LPJG_NUMPROC=48 OSM_NUMTHREADS=24  !!!
PROCESSORS = 144
#! QUEUE = debug


##PROCESSORS = 96
#CUSTOM_DIRECTIVES = ["#SBATCH --qos=debug"]
#PROCESSORS = 41
#CUSTOM_DIRECTIVES = ["#SBATCH --qos=debug", "#SBATCH --exclusive","#SBATCH --ntasks-per-node=24"]
#CUSTOM_DIRECTIVES = ["#SBATCH --qos=debug", "#SBATCH --exclusive","#SBATCH --ntasks-per-node=20"]

#[CMOROCE]
#FILE = templates/common/cmoroce.tmpl.sh
#DEPENDENCIES = SIM
#WALLCLOCK = 1:00
#RUNNING = chunk
#NOTIFY_ON = RUNNING FAILED COMPLETED
#TASKS = 8
#QUEUE = debug
#CUSTOM_DIRECTIVES = ["#SBATCH --exclusive"]
#CHECK = true

#[CMORATM]
#FILE = templates/common/cmoratm.tmpl.sh
#DEPENDENCIES = SIM SIM+1
#WALLCLOCK = 2:00
#RUNNING = chunk
#NOTIFY_ON = RUNNING FAILED COMPLETED
#CUSTOM_DIRECTIVES = ["#SBATCH --exclusive"]
#QUEUE = debug
#CHECK = true

[CMORLPJG]
FILE = templates/common/cmorlpjg.tmpl.sh
DEPENDENCIES = SIM
WALLCLOCK = 2:00
RUNNING = chunk
NOTIFY_ON = RUNNING FAILED COMPLETED
CUSTOM_DIRECTIVES =  ["#SBATCH --exclusive"]
#QUEUE = debug
#CHECK = true

#[CMORTM5]
#FILE = templates/common/cmortm5.tmpl.sh
#DEPENDENCIES = SIM
#WALLCLOCK = 2:00
#RUNNING = chunk
#NOTIFY_ON = RUNNING FAILED COMPLETED
#CUSTOM_DIRECTIVES = ["#SBATCH --exclusive"]
#QUEUE = debug
#CHECK = true

[POST]
FILE = templates/common/post.tmpl.sh
#PLATFORM = nord3
DEPENDENCIES = SIM SIM+1 POST-1 CMORLPJG
RUNNING = chunk
WALLCLOCK = 02:00
# when using the classic outclass make sure you are running POST in exclusive mode (for MN4): CUSTOM_DIRECTIVES = ["#SBATCH --exclusive"]
#! QUEUE = debug
CHECK = true

[CLEAN]
FILE = templates/common/clean.tmpl.sh
PLATFORM = transfer_node
DEPENDENCIES = POST SIM SIM+1 CMORLPJG
RUNNING = chunk
WALLCLOCK = 00:30
CHECK = true

#[SAVEIC]
#FILE = templates/common/saveic.tmpl.sh
#DEPENDENCIES = SIM
#RUNNING = chunk
#WALLCLOCK = 01:00
#CHECK = true
#NUMPROC = 1
#CUSTOM_DIRECTIVES = ["#SBATCH --exclusive", "#SBATCH --cpus-per-task=24" ]

[CLEAN_MEMBER]
FILE = templates/common/clean_member.tmpl.sh
PLATFORM = transfer_node
DEPENDENCIES = CLEAN PERFORMANCE_METRICS
RUNNING = member
WALLCLOCK = 02:00
CHECK = true

[PERFORMANCE_METRICS]
FILE = templates/common/performance_metrics.tmpl.sh
DEPENDENCIES = CLEAN
RUNNING = once
PROCESSORS = 1
PLATFORM = LOCAL
CHECK = true

[TRANSFER_MEMBER]
FILE = templates/common/transfer_member.tmpl.sh
PLATFORM = transfer_node
DEPENDENCIES = CLEAN_MEMBER
RUNNING = member
CHECK = true

[NCTIME]
FILE = templates/common/nctime.tmpl.sh
PLATFORM = cte-power
DEPENDENCIES = NCTIME-1 CLEAN CLEAN-1 CLEAN-2
RUNNING = chunk
FREQUENCY = 3
CHECK = true
WALLCLOCK = 01:00

[NCTIME_MEMBER]
FILE = templates/common/nctime_member.tmpl.sh
PLATFORM = cte-power
DEPENDENCIES = CLEAN_MEMBER TRANSFER_MEMBER
RUNNING = member
CHECK = true
WALLCLOCK = 01:00

