[LOCAL_SEND_SPINUP]
FILE = templates/00d_local_send_spinup.sh
PLATFORM = marenostrum_archive
RUNNING = member
NOTIFY_ON = FAILED

[LOCAL_SEND_SOURCE]
FILE = templates/01_local_send_source.sh
PLATFORM = marenostrum_archive
RUNNING = once
NOTIFY_ON = FAILED

[LOCAL_SEND_STATIC]
FILE = templates/01b_local_send_static.sh
PLATFORM = marenostrum_archive
RUNNING = once
NOTIFY_ON = FAILED

[REMOTE_COMPILE]
FILE = templates/02_compile.sh
DEPENDENCIES = LOCAL_SEND_SOURCE
RUNNING = once
WALLCLOCK = 00:50
CUSTOM_DIRECTIVES = ["#SBATCH -p interactive"]
NOTIFY_ON = FAILED

#** Remember to define a proper wallclock matching the configuration (resolution) of the model **
#** Remember that PROCESSORS must be equal to INPES*JNPES+WRTSK **
[SIM]
FILE = templates/05b_sim.sh
DEPENDENCIES = LOCAL_SEND_SPINUP LOCAL_SEND_STATIC REMOTE_COMPILE SIM-1 DA-1
# DEPENDENCIES = SIM-1 DA-1
RUNNING = chunk
PROCESSORS = 768
# WALLCLOCK = 00:50
WALLCLOCK = 00:40
NOTIFY_ON = FAILED 
# QUEUE = debug

[LOCAL_SEND_INITIAL_DA]
FILE = templates/00b_local_send_initial_DA.sh
PLATFORM = marenostrum_archive
DEPENDENCIES = LOCAL_SEND_INITIAL_DA-10
RUNNING = chunk
SYNCHRONIZE = member
DELAY = 0
NOTIFY_ON = FAILED 

[DA]
FILE = templates/05c_da.sh
DEPENDENCIES = SIM LOCAL_SEND_INITIAL_DA
#DEPENDENCIES = SIM 
RUNNING = chunk
SYNCHRONIZE = member
DELAY = 0
# WALLCLOCK = 00:50
WALLCLOCK = 00:40
PROCESSORS = 576
NOTIFY_ON = FAILED 
# QUEUE = debug

[REDUCE]
FILE = templates/07_reduce.sh
DEPENDENCIES = SIM DA
RUNNING = chunk
WALLCLOCK = 00:50
NOTIFY_ON = FAILED 
PROCESSORS = 4
MAX_WRAPPED = 12
# QUEUE = debug

[CALCSTATS]
FILE = templates/07b_calc_stats_split.sh
DEPENDENCIES = REDUCE
RUNNING = chunk
SYNCHRONIZE = member
WALLCLOCK = 00:50
NOTIFY_ON = FAILED
PROCESSORS = 48
SPLITS = 10
# CUSTOM_DIRECTIVES = ["#SBATCH --exclusive", "#SBATCH --constraint=highmem"]
# QUEUE = debug


[ARCHIVE]
FILE = templates/06_archive.sh
DEPENDENCIES = REDUCE ARCHIVE-1
PLATFORM = marenostrum_archive
RUNNING = chunk
WALLCLOCK = 01:00
NOTIFY_ON = FAILED 

[ARCHIVE_REDUCE]
FILE = templates/06c_archive_reduce.sh
#DEPENDENCIES = REDUCE
DEPENDENCIES = CALCSTATS
PLATFORM = marenostrum_archive
RUNNING = chunk
SYNCHRONIZE = member
WALLCLOCK = 01:00
NOTIFY_ON = FAILED

#[CLEAN]
#FILE = templates/08_clean.sh
#DEPENDENCIES = REDUCE
#RUNNING = date
#WALLCLOCK = 02:00
#NOTIFY_ON = FAILED 
