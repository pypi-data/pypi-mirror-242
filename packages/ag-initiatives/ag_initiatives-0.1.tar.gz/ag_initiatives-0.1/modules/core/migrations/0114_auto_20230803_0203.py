# Generated by Django 2.2.5 on 2023-08-02 19:03

from django.db import migrations, models


def migrate_sub_permissions(apps, schema_editor):
    user = apps.get_model('core', 'User')
    for i in user.objects.all():
        if hasattr(i, 'sub_permissions'):
            sub_permissions = i.sub_permissions
            if hasattr(sub_permissions, 'admin_lko_permissions'):
                i.admin_lko_permissions = sub_permissions.admin_lko_permissions
                i.save()
                i.admin_lko_permissions.save()
            if hasattr(sub_permissions, 'operator_permissions'):
                i.operator_permissions = sub_permissions.operator_permissions
                i.save()
                i.operator_permissions.save()


class Migration(migrations.Migration):
    dependencies = [
        ('core', '0113_operatorlkopermissions_appeals_categories'),
    ]

    operations = [
        migrations.RemoveField(
            model_name='departmentsubpermissions',
            name='appeals_categories',
        ),
        migrations.AddField(
            model_name='departmentsubpermissions',
            name='appeals_categories',
            field=models.ManyToManyField(blank=True, null=True,
                                         related_name='department_appeals_categories_permissions',
                                         to='feedback.Problematic',
                                         verbose_name='Проблематика для модуля «Ваше мнение»'),
        ),
        migrations.RunPython(migrate_sub_permissions),
    ]
